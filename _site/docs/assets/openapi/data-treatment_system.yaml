openapi: 3.0.0
servers:
  - url: 'https://server/api/connectedcar/v1'
info:
  version: '1.0'
  title: Stellantis Connected Car API
  description: >
    *Connected Car API*
    
   
    # Introduction

    This is the description of the *Stellantis Connected Car V2 API*. The
    speccification is  is based on **OpenAPI Specification version 3** and can be displayed using [ReDoc](https://github.com/Rebilly/ReDoc)a or
    [Swagger](http://swagger.io).
    
    
      This API allows applications to fetch data from the Connected Vehicles Data Platform. It is designed to be **a declarative data and function specification**, so they are understood and consumed by stakeholders without knowledge of manufacturer onboard vehicle specification
    
    ---
    
    # API features
    
    
     ## Vehicles:
      <i>Access to static vehicle resources such as brand, description and images as well as the IoT data.</i>
    ##  Trips:
      <i>Access to the trips traveled by the vehicle and their data such as telemetry, alerts and waypoints, etc.</i>
     ## Channel:
     <i> Definition of an output channel that can be used as a return channel for the Monitor and Remote functions or as an output for the datastream.</i>
     ## Monitor:
      <i>Creating a monitor with several flags that define a logical expression that is the exact functional condition for triggering the monitor. It is also possible to define the actions (remote action or monitor changes) to invoke when receiving a particular monitor event. Thus, it can be possible to automate scenarios.</i>
     ## Remote:
      <i>Send the remote command to the vehicle. It is also possible to define the actions (remote action or monitor changes) to invoke when receiving a particular remote event callback status. Thus, it can be possible to automate scenarios.</i>
    ##  Datastream:
      <i>Create output data streams on a defined channel. Data sent on this stream are the same as that exposed by the APIs.</i>
      
      ---
      
    
    # API Authentication
    
      Stellantis Connected Car APIs uses the [OAuth  2.0](https://tools.ietf.org/html/rfc6749) protocol for authentication and
      authorization. Any application require a valid [Access Token](https://tools.ietf.org/html/rfc6749#section-1.4) to access to data.
     
      
            
      ## Hierarchical Scopes

    
      Since api resources are hierarchical, API uses also hierarchical scopes. 
        _Colon characters_ are used to navigate to subresource scopes.
    
    
      ## Filtering Scopes
    
      - When the API caller requests a set of scopes. The owner may not grant access to all of the requested scopes, so the application will have to adapt to the restricted access or request for a larger set of scopes again.
      - API backend will deliver the data related to the granted scopes only. 
      - If no scope has been granted with the caller token then an unauthorized error will be returned.
          
        _If for example the API caller requests for "aggregated telemetry" or "trip" without having the "location" scope, then the resource data returned will not have the vehicle's position but only other data that will satisfy the scopes present in the token._
          
      **The scopes used to request access to resources for the OAuth2 security scheme fall into four categories:**

      #### _1. <u>IoT data scopes:</u>_
      |<b>Scope</b>  |<b>Description</b>  | 
      |---|---|
      |vehicle| read Vehicle attributes (details) data|
      |telemetry| read full telemetry data|
      |telemetry:environment|read telemetry environment data|
      |telemetry:privacy|read telemetry privacy data|
      |telemetry:vehicle|read full telemetry vehicle data|
      |telemetry:vehicle:ignition|read telemetry vehicle ignition data|
      |telemetry:vehicle:preconditioning|read telemetry vehicle preconditioning system data|
      |telemetry:vehicle:energies|read telemetry vehicle all energies data:<i> level, autonomy, consumptions, eletric residual, eletric battery state, eletric charging state</i>|
      |telemetry:vehicle:engines|read telemetry vehicle all engines data:<i> speed, gmp, extensions (thermal: oil, src...)</i>|
      |telemetry:vehicle:doorsState|read telemetry vehicle doors state data|
      |telemetry:vehicle:battery|read telemetry vehicle status battery data|
      |telemetry:vehicle:safety|read telemetry vehicle safety (Seat belt, ecall ..) data|
      |telemetry:vehicle:odometer|read telemetry vehicle odometer data|
      |telemetry:vehicle:kinetic|read telemetry vehicle kinetic data|
      |telemetry:vehicle:propulsion|read telemetry vehicle propulsion mode|
      |telemetry:vehicle:brakingSystem|read telemetry vehicle braking system data|
      |telemetry:vehicle:transmission|read telemetry vehicle transmission data|
      |telemetry:vehicle:adas|read telemetry vehicle ADAS data|
      |telemetry:vehicle:lighting|read telemetry vehicle lighting system data|
      |telemetry:vehicle:maintenance |read telemetry vehicle maintenance data|
      |telemetry:vehicle:drivingBehavior|read telemetry driver behavior data|
      |location| read vehicle  Location (position) data|
      |trip| read Trip related data|
      |alert| read alert related data|
      |collision| read Collision related data|
      #### _2. <u>Notification channel scopes:</u>_
      |<b>Scope</b>  |<b>Description</b>  | 
      |---|---|       
      |channel| read calback related data|
      |channel:<b>write</b>| create, modify or delete channels|
      #### _3. <u>Vehicle monitor scopes:</u>_
      |<b>Scope</b>  |<b>Description</b>  | 
      |---|---|       
      |monitor| read monitors|
      |monitor:<b>write</b>| create, modify or delete Monitors|
      #### _4. <u>Datastream scopes:</u>_
      |<b>Scope</b>  |<b>Description</b>  | 
      |---|---|       
      |datastream| read exisiting datastream (subscribed, status...) setting|
      |datastream:<b>write</b>| create, modify or delete datastreams|
      #### _5. <u>Vehicle remotes scopes:</u>_
      |<b>Scope</b>  |<b>Description</b>  | 
      |---|---|            
      |remote| read full remote state(pending & history)|
      |remote:door:lock| read door Lock remote (pending & history)|      
      |remote:door:lock:<b>write</b>| send a door Lock remote to vehicle|
      |remote:door:unlock| read door Lock remote (pending & history)| 
      |remote:door:unlock:<b>write</b>| send a door Unlocked remote to vehicle|
      |remote:preconditioning| read door Lock remote (pending & history)| 
      |remote:preconditioning:<b>write</b>| send a precondioning remote to vehicle|
      |remote:horn| read horn remote  (pending & history)| 
      |remote:horn:<b>write</b>| send a horn remote to vehicle|
      |remote:immo| read immobilization remote (pending & history)| 
      |remote:immo:<b>write</b>| send an immobilization remote to vehicle|
      |remote:charging| read charging remote (pending & history)| 
      |remote:charging:<b>write</b>| send charging remote to vehicle|
      |remote:stolen| read stolen-set remote (pending & history)| 
      |remote:stolen:<b>write</b>| send remote to set vehicle as stolen|
      |remote:lights| read lights remote (pending & history)| 
      |remote:lights:<b>write</b>| send remote to switch on/off vehicle lights|
      |remote:weakup| read weackup remote (pending & history)| 
      |remote:weakup:<b>write</b>| send remote to weackup vehicle|
      |remote:navigation| read navigation remote (pending & history)| 
      |remote:navigation:<b>write</b>| send navigation remote to vehicle|    
    
    ---
    
    # API Navigability:
      These APIs use [HATEOAS]([https://en.wikipedia.org/wiki/HATEOAS#Implementations) as standard convention for defining resources discovery and navifability (thanks to related hyperlinks).
      Adopting HAL simplifies the use of open source libraries and make it possible to interact with the API using JSON.
    ---          
    
    # API Paging:
    
    To make this necessary feature easy to use when retrieving a collection of results, this API uses a token (computed and interpreted by the backend only) as a context that contains all necessary information allowing the navigation through pages. 
      Token acts as an ```HTTP COOKIE``` on the client-side, so the server does not keep any cache or session settings to continue paging and keep all request stateless. These tokens are used to build HAL (Hypertext Application Language) hyperlinks also.
          
    ---
    
    # API Errors:
      Error codes returned by all APIs comply with the standard. Nevertheless, PSA Services (callers) need to have more detailed data structures (even when the answer is not Http-OK) to better categorize the type of error by providing application code, message and debugging code(for investigation purposes). The HTTP code of the response is managed by the protocol itself (in the header).
        
      ### These APIS are likely to report the following HTTP code:
      
      |<b>Code</b>  |<b>Description</b>  | <b>Case</b> | 
      |---|---|---|
      |200  |<i>The request has succeeded and the resource data has been sent.</i>|GET APIs.  |
      |202  |<i>The request has been accepted for processing, but not yet acted upon. An id of processing is returned.</i>|POST/PUT requests:<br>-Create monitor<br>-Create a callbak.| 
      |204  |<i>The request has been accepted and there is no additional content</i>|DELTE APIs:<br>-Delete monitor.<br>-Delete a channel.|
      |400|<i>Request cannot be processed due to invalid query parameter value of body content (for POST/PUT verbs)</i>|ALL APIs.|
      |401|<i>Unauthorized request due to lack of valid authentication credentials.</i>|All APIs.|
      |403|<i>Unauthorized request due to insufficient credentials to grant access.</i>|All APIs.|
      |404|<i>Target resource not found.|All APIs. Even POST, PUT or DELETE if the resource id is uncknown.</i>|
      |500|<i>Unexpected condition that prevented from fulfilling the reques.</i>|All APIs.|


      
      **Errors are  returned as a generic error response:**
       * See ```ErrorCodeDefaultResponse``` model.
       
    ---
    
    # API output:
     
      ## Data format
      
      **All APIs return data in JSON format. The application who uses them must take into account the evolving character of them and more precisely regarding the schemas of the exposed data. Indeed:**
      
      *  The missing of known data fields should not cause an error. 
      *  It should (correctly)  deal with JSON content with unknown properties also. Indeed, data schema extensions should be supported without errors even if they are not used. 
        
      
      **for example:**
      
      Assuming a given exposed resource with this data schema:
        
          
           data:
            type: object
            description: Data model
            properties:
              field1:
                type: string
              field2:
                type: number
             
      The application should be able to deal with those possible valid JSON contents:
        
      > All fields:
        ```{
          "field1":"value1",
          "field2": 1
        }```
        
      > Missing field2:
        ```{
          "field1":"value1"
        }```        

      > Unknow  field3:
        ```{
          "field1":"value1",
          "field3": 2.5
        }```
      
     
    ---     
    
    
    
  license:
    name: Stellantis Licence
    url: 'https://www.psa-peugeot-citroen.com/'
  
tags:
  - name: Vehicles
    description: Access to attributes and IoT data associated with the vehicle.
  - name: Trips
    description: Describe Trips of a vehicle.
  - name: Channels
    description: Describe a subscription to an output channel for remote or monitor notification events or data-stream features.
  - name: Grouping
    description: Allows to organize the vehicles (of the owner) by group(s) according to functional criteria. Groups allow collective action on a set of vehicles, such as subscription to a monitor or a data stream (*remote remains applicable to the vehicle individually*)
  - name: Monitors
    description: Describe the vehicle monitor features.
  - name: Remotes
    description: Describe the vehicle remote features.
  - name: Datastream
    description: Describe the data stream feature allowing the publication of defined stream data on the associated output <b>channel</b>


paths:

  /vehicles:
    $ref: '#/x-fragment/Vehicles_getter'
  /vehicles/{id}:
    $ref: '#/x-fragment/Vehicle_id_getter'    
      
  /vehicles/{id}/telemetries:
    $ref: '#/x-fragment/Vehicle_id_telemetries_getter'
    
  /vehicles/{id}/lastTelemetries:
    $ref: '#/x-fragment/Vehicle_id_lasttelemetries_getter'
     
  /vehicles/{id}/collisions:
    $ref: '#/x-fragment/Vehicle_id_collisions_getter'
   
  /vehicles/{id}/collisions/{cid}:
    $ref: '#/x-fragment/Vehicle_id_collisions_by_id_getter'
     
  /vehicles/{id}/alerts:
    $ref: '#/x-fragment/Vehicle_id_alerts_getter'
     
  /vehicles/{id}/alerts/{aid}:
    $ref: '#/x-fragment/Vehicle_id_alert_by_id_getter'
    
  /vehicles/{id}/alarms:
    $ref: '#/x-fragment/Vehicle_id_alarms_getter'
    
  /vehicles/{id}/alarms/{aid}:
     $ref: '#/x-fragment/Vehicle_id_alarm_aid_getter'
  /vehicles/{id}/trips:
    $ref: '#/x-fragment/Vehicle_id_Trips'

  /vehicles/{id}/trips/{tid}:
    $ref: '#/x-fragment/Vehicle_id_Trip_id'

  /vehicles/{id}/trips/{tid}/alerts:
    $ref: '#/x-fragment/Vehicle_id_Trip_id_Alerts_getter'

  /vehicles/{id}/trips/{tid}/alerts/{aid}:
    $ref: '#/x-fragment/Vehicle_id_Trip_id_Alerts_id_getter'

  /vehicles/{id}/trips/{tid}/collisions:
    $ref: '#/x-fragment/Vehicle_id_Trip_id_Collisions_getter'

  /vehicles/{id}/trips/{tid}/collisions/{cid}:
    $ref: '#/x-fragment/Vehicle_id_Trip_id_Collisions_id_getter'

  /vehicles/{id}/trips/{tid}/wayPoints:
    $ref: '#/x-fragment/Vehicle_id_Trip_id_wayPoints_getter'

  /vehicles/{id}/trips/{tid}/telemetry:
    $ref: '#/x-fragment/Vehicle_id_Trip_id_Telemetry_getter'

  /channels/{chId}/monitors:
    $ref: '#/x-fragment/Vehicle_id_cb_id_monitors_get_post'
 
  /channels/{chId}/monitors/{mid}:
    $ref: '#/x-fragment/Vehicle_id_cb_id_monitors_mid_crud'
 
  /channels/{chId}/monitors/{mid}/status: 
    $ref: '#/x-fragment/ch_id_monitor_id_setter_put' 
    
  /channels/{chId}/monitors/{mid}/handle: 
    $ref: '#/x-fragment/ch_id_monitor_id_handle'
  
  /channels:  
    $ref: '#/x-fragment/channels_crud' 
            
  /channels/{chId}:
    $ref: '#/x-fragment/channel_id_crud'

  /channels/{chId}/status: 
    $ref: '#/x-fragment/channel_id_status_put'
          
  /vehicles/{id}/channels/{chId}/remotes:
    $ref: '#/x-fragment/Vehicle_id_channel_id_remotes_crud'

  /vehicles/{id}/channels/{chId}/remotes/{rid}:
    $ref: '#/x-fragment/Vehicle_id_channel_id_remotes_id_getter'


  #### GROUPS
  '/groups':

    post:
      tags:
        - Grouping
      summary: Create a group.
      description: |
                    Create an empty group. 
      operationId: createGroup
     
      requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/GroupObj'
      responses: #MonitorId
          202:
            $ref: '#/components/responses/GroupSuccessResponse'
          default:
           $ref: '#/x-fragment/general_error_fragment'
    get:
      tags:
        - Grouping
      summary: Get all vehicles groups.
      description: Returns the all vehicle groups.
      operationId: getDGrps
      parameters:
          - $ref: '#/components/parameters/pageSize'
          - $ref: '#/components/parameters/pageToken'
      responses:
        200:
          $ref: '#/components/responses/GroupsSuccessResponse' 
        default:
          $ref: '#/components/responses/DatastreamFailedResponse'
          
  '/groups/{gId}':
    get:
      tags:
        - Grouping
      summary: Get group by id.
      description: Returns the vehicles group requested for a channel by ID.
      operationId: getDSForFid
      parameters:
          - $ref: '#/components/parameters/groupId'
      responses:
        200:
          $ref: '#/components/responses/GroupSuccessResponse' 
        default:
          $ref: '#/x-fragment/general_error_fragment'  
          
    delete:
      tags:
        - Grouping
      summary: Delete an vehicle group.
      description: Remove an existing group. Only the group will be removed and all associated vehicles will remain associared to the root group and otherd groups(if appliable).
      operationId: deleteDS
      parameters:
          - $ref: '#/components/parameters/groupId'
      responses:
        204:
          description: Group deleted (the response does not include an entity)
        '400':
          description: Invalid ID supplied or if trying to delete the root (master) group.
        '404':
          description: Group stream not found   
    put:
        tags:
          - Grouping
        summary: Maintain group.
        description: Add or remove vehicles to/from group. 
        operationId: addRmVhlGrp
        parameters:
            - $ref: '#/components/parameters/groupId'
        security:
          - api_oauth:
              - channel
              - monitor:write        
        requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/GroupMaintain'
        responses: #MonitorId
          202:
            $ref: '#/components/responses/GroupSuccessResponse'
          default:
            $ref: '#/x-fragment/general_error_fragment'           
  ####################### #DataStream  channelType
  
             

          
  '/channels/{chId}/datastreams/{did}':
    get:
      tags:
        - Datastream
      summary: Get Datastream by id.
      description: Returns the Datastream requested for a channel by ID.
      operationId: getDSForChIdDid
      parameters:
          
          - $ref: '#/components/parameters/channelId'
          - $ref: '#/components/parameters/datastreamId'
          
      responses:
        200:
          $ref: '#/components/responses/DatastreamSuccessResponse' 
        default:
          $ref: '#/components/responses/DatastreamFailedResponse'  
    put:
      tags:
        - Datastream
      summary: update an existing data stream.
      description: |
                    Subscribe  to data stream. 
      operationId: updateeDatastream
      parameters:
          - $ref: '#/components/parameters/channelId'
          - $ref: '#/components/parameters/datastreamId'
      requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/DataStream'
      responses: #MonitorId
          202:
            $ref: '#/components/responses/DataStreamSuccessPostResponse'
          default:
           $ref: '#/x-fragment/general_error_fragment' 
    delete:
      tags:
        - Datastream
      summary: Delete an existing data stream.
      description: Remove an existing data stream .
      operationId: deleteCH
      parameters:
          - $ref: '#/components/parameters/channelId'
          - $ref: '#/components/parameters/datastreamId'
      responses:
        204:
          description: data stream deleted (the response does not include an entity)
        '400':
          description: Invalid ID supplied
        '404':
          description: data stream not found           
  '/channels/{chId}/datastreams':
    post:
      tags:
        - Datastream
      summary: subscribe  to data stream.
      description: |
                    Subscribe  to data stream. 
      operationId: subscribeDatastream
      parameters:
          - $ref: '#/components/parameters/channelId'
      requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/DataStream'
      responses: #MonitorId
          202:
            $ref: '#/components/responses/DataStreamSuccessPostResponse'
          default:
           $ref: '#/x-fragment/general_error_fragment'
  
    get:
      tags:
        - Datastream
      summary: Get all subscribed data stream associated to a channel.
      description: Returns the list of datastream  registered for a channel.
      operationId: getDSListForFid
      parameters:
          
          - $ref: '#/components/parameters/channelId'
          - $ref: '#/components/parameters/callbackIdFilter'
          - $ref: '#/components/parameters/indexRange'
          - $ref: '#/components/parameters/pageSize'
          - $ref: '#/components/parameters/pageToken'
          
      responses:
        200:
          $ref: '#/components/responses/DatastreamsSuccessResponse' 
        default:
           $ref: '#/x-fragment/general_error_fragment' 

  /channels/{chId}/datastreams/{did}/status: 
    put:
        tags:
          - Datastream
        summary: Set a new data stream status.
        description: Set data stream status. 
        operationId: setVehicleDataStreamStatus
        parameters:
            - $ref: '#/components/parameters/channelId'
            - $ref: '#/components/parameters/datastreamId'
        security:
          - api_oauth:
              - channel
              - monitor:write        
        requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/DataStreamStatusSetter'
        responses: #MonitorId
          202:
            $ref: '#/components/responses/DataStreamSuccessPostResponse'
          default:
            $ref: '#/x-fragment/general_error_fragment' 
  /channels/{chId}/datastreams/{did}/handle:
    $ref: '#/x-fragment/ch_id_ds_id_handle'

####### Resuseable componenet resources. ###### 
components:
  securitySchemes:
    api_keyAuth:        
      type: apiKey
      in: query      
      name: client_id  # name of the header, query parameter or cookie
    api_oauth:
      type: oauth2
      description: This API uses OAuth 2 with the implicit grant flow. [More info](https://api.example.com/docs/auth)
      flows:
        implicit:
          authorizationUrl: 'https://api.mpsa.com/api/connectedcar/v2/oauth/authorize'
          scopes:
            vehicle: read Vehicle attributes (details) data
            telemetry: read full telemetry data
            telemetry:environment: read telemetry environment data
            telemetry:privacy: read telemetry privacy data
            telemetry:vehicle: read full telemetry vehicle data
            telemetry:vehicle:ignition: read telemetry vehicle ignition data
            telemetry:vehicle:preconditioning: read telemetry vehicle preconditioning system data
            telemetry:vehicle:energies: read telemetry vehicle all energies data
            telemetry:vehicle:engines: read telemetry vehicle all engines data
            telemetry:vehicle:doorsState: read telemetry vehicle doors state data
            telemetry:vehicle:battery: read telemetry vehicle battery status data
            telemetry:vehicle:safety: read telemetry vehicle safety  (Seat belt, ecall ..)  data
            telemetry:vehicle:odometer: read telemetry vehicle odometer data
            telemetry:vehicle:kinetic: read telemetry vehicle kinetic data
            telemetry:vehicle:propulsion: read telemetry vehicle propulsion mode
            telemetry:vehicle:brakingSystem: read telemetry vehicle braking system data
            telemetry:vehicle:transmission: read telemetry vehicle transmission data
            telemetry:vehicle:adas: read telemetry vehicle ADAS data
            telemetry:vehicle:lighting: read telemetry vehicle lighting system data
            telemetry:vehicle:maintenance: read telemetry vehicle maintenance data
            telemetry:vehicle:drivingBehavior: read telemetry vehicle driver bihavior data 
            location: read vehicle Location (position) data
            trip: read Trip related data
            alert: read alert related data
            collision: read Collision related data
            channel: read calback related data
            channel:write: create, modify or delete channels
            monitor: read monitors
            monitor:write: create, modify or delete Monitors
            remote: read full remote state(pending & history)
            remote:door:lock: read door Lock remote (pending & history)
            remote:door:lock:write: send a door Lock remote to vehicle
            remote:door:unlock: read door Lock remote (pending & history)
            remote:door:unlock:write: send a door Unlocked remote to vehicle
            remote:preconditioning: read door Lock remote (pending & history)
            remote:preconditioning:write: send a precondioning remote to vehicle
            remote:horn: read horn remote (pending & history)
            remote:horn:write: send a horn remote to vehicle
            remote:immo: read immobilization remote (pending & history)
            remote:immo:write: send an immobilization remote to vehicle
            remote:charging: read charging remote (pending & history)
            remote:charging:write: send charging remote to vehicle
            remote:stolen: read stolen-set remote (pending & history)
            remote:stolen:write: send remote to set vehicle as stolen
            remote:lights: read lights remote (pending & history)
            remote:lights:write: send remote to switch on/off vehicle lights
            remote:weakup: read weackup remote (pending & history)
            remote:weakup:write: send remote to weackup vehicle
            remote:navigation: read navigation remote (pending & history)
            remote:navigation:write: send navigation remote to vehicle
                  
            
  schemas:
    Tab_Links:
      description: >
        [HAL](https://en.wikipedia.org/wiki/Hypertext_Application_Language#Convention)
        (Hypertext Application Language) link collection
#      
      type: object
      properties:
        self:
          $ref: '#/components/schemas/Link'
        first:
          $ref: '#/components/schemas/Link'
        next:
          $ref: '#/components/schemas/Link'
        prev:
          $ref: '#/components/schemas/Link'
        last:
          $ref: '#/components/schemas/Link'
   
    CollectionResult:
      type: object
      properties:
        _links:
          $ref: '#/components/schemas/Tab_Links'
        total:
          type: integer
        totalPage:
          type: integer
        currentPage:
          type: integer
        _embedded:
          type: object
      required: [total, totalPage, currentPage, _embedded]
      
    BasicAlert:
          title: Alert message
          type: object
          properties:
            _links:
              type: object
              properties:
                self:
                  $ref: '#/components/schemas/Link'
                vehicle:
                  $ref: '#/components/schemas/Link'
                position:
                  $ref: '#/components/schemas/Link'
                trips:
                  $ref: '#/components/schemas/Link'

            active:
              type: boolean
            type:
              $ref: '#/components/schemas/AlertMsgEnum'
            severity:
              description: |
                            Alert severity level.
                            
                            |Severity|Description|
                            |:---|:---|
                            |Information|Better to fix but it is operating accurately.|
                            |Warning|Should fix it asap.|
                            |Critical|Starting prohibited without repair.|                           
#              
              type: string
              enum: [Information, Warning, Critical]
            startedAt:
              type: string
              format: date-time
            endAt:
              type: string
              format: date-time
            startPosition:
              allOf:
                - $ref: '#/components/schemas/Position'
                - description: The position (last vehicle known one) where the alert disappear.
            endPosition:
              allOf:
                - $ref: '#/components/schemas/Position'
                - description: The position (last vehicle known one) where the alert occurs. 
          required: [ id,active,type,updatedAt,startedAt]        
   
    Alert:
      allOf: 
        - $ref: '#/components/schemas/CreatedAtField'
        - $ref: '#/components/schemas/UpdatedAtField' 
        - $ref: '#/components/schemas/BasicAlert'
          
    ActiveAlerts:
                    allOf:
                      - description: |
                                      latest active (pending) and known Alerts on the vehicle. 
                                      * Since the returned alerts are active, their 'endPosition' will be of the last known positions where the alerts were still active.
                      - type: array
                        items:
                            $ref: '#/components/schemas/Alert'
    ActiveAlertsBase:
                    allOf:
                      - description: |
                                      Active (pending) Alerts on the vehicle. 
                                      * Since the returned alerts are active, their 'endPosition' will be of the last known positions.
                      - type: array
                        items:
                            $ref: '#/components/schemas/BasicAlert'                            
    Url:
      type: string
      description:  URL format follows [RFC 3986](https://tools.ietf.org/html/rfc3986) and
        usually looks like this ` scheme://host[:port][/Path] `
    Link:
      type: object
      description: A Link Object as defined by [JSONHAL#Link
        Object](https://tools.ietf.org/html/draft-kelly-json-hal-08#section-5).
      required:
        - href
      properties:
        href:
          $ref: '#/components/schemas/Url'
        templated:
          type: boolean
          description: SHOULD be true when the Link Object's "href"   property is a URI
            Template
        type:
          type: string
          description: a hint to indicate the media type  expected when dereferencing the
            target resource.
        deprecation:
          allOf:
            - $ref: '#/components/schemas/Url'
            - description:  indicates that the link is to be deprecated (i.e. removed) at a
                future date.  Its value is a URL that SHOULD provide further
                information about the deprecation.
        name:
          type: string
        title:
          type: string
          description: Its value is a string and is intended for labelling the link with a
            human-readable identifier (as defined by
            [RFC5988](https://tools.ietf.org/html/rfc5988)).
        profile:
          type: string
          description: Its value is a string and is intended for indicating the language of
            the target resource (as defined by [RFC5988]).
        hreflang:
          type: string
          description: Its value is a string which is a URI that hints about the profile
            (as defined by
            [I-D.wilde-profile-link](https://tools.ietf.org/html/draft-kelly-json-hal-08#ref-I-D.wilde-profile-link))
            of the target resource.
   
    CollisionDetails:
        type : object
        properties:
          side:
            type: string
            description: Indicates the side of the collision
            enum: [Front, Rear, Lateral]
          severity:
            type: string
            enum: [Minimal, Minor, Major]
            description: >-
                * Minimal stands for no emergency system activated during the collision.
                
                * Minor only pretensioner system activated.
                
                * Major for airbag and prentensioner activation.
#                
    CollisionObj:
     allOf:
        - title: Collision
          type: object
          properties:
            details:
                type : array
                items : 
                  $ref: '#/components/schemas/CollisionDetails'
    
    Collision:
     allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - $ref: '#/components/schemas/CollisionObj'
        - title: Collision
          type: object
          properties:
            
            tippedOver:
              type: boolean
              description: >-
                    Indicates if the car tipped over during the collision.
                    Warning : This information is applicable only on vehicles equipped with dedicated sensor and is optionnal
#                    
            pedestrian:
              type: boolean
              description: >-
                    Indicates if the collision involve a pedestrian.
                    Warning : This information is applicable only on vehicles equipped with dedicated sensor and is optionnal
#                    
            updatedAt:
              type: string
              format: date-time
            _links:
              type: object
              properties:
                self:
                  $ref: '#/components/schemas/Link'
                vehicle:
                  $ref: '#/components/schemas/Link'
                trip:
                  $ref: '#/components/schemas/Link'
          required: [ id ]
          
    ECoaching:
      title: ECoaching response
      type: object
      properties:
        _links:
          type: object
          properties:
            self:
              $ref: '#/components/schemas/link'
            vehicle:
              $ref: '#/components/schemas/link'
            trip:
              $ref: '#/components/schemas/link'
       
        scores:
          type: array
          items:
              type: object
              properties:
                category:
                  type: string
                  description: category of the score. Global, ACCELERATION, BREAKING, A/C system, Runing cold engine, Direct Shift Gear, Speed, STT system, ZEV (Zero emission vehicle).
                  enum: [Global, Acceleration, Break, AirCondioner, ColdEngine, TirePressure, Slope, Speed, StartStop]
                score:
                  type: number
                  minimum: 0
                  maximum: 10
       
        _embedded:
          type: object
    
    EngineLiquid:
                              type: object
                              properties:
                                level:
                                  description: Engine liquid level expressed in persent.
                                  type: number
                                  format: int
                                temp:
                                  description: Engine liquid temperature expressed in Celsius degrees.
                                  type: number
                                  format: float          
    Engines:
      type: array
      items: 
         $ref: '#/components/schemas/Engine'
    EngineBases:
      type: array
      items: 
         $ref: '#/components/schemas/EngineBase'         
    EngineBase:
          type: object
          properties:
                  type:
                          type: string
                          default: Thermic
                          enum:
                            - Thermic
                            - Electric
                  oil:
                    type: object 
                    deprecated: true
                    description: depricated, use extention thermic for such purpose.
                    properties:
                      temp:
                        type: number
                        format: float
                  speed:
                    type: number
                    format: float
                  gmpStatus:
                    type: string
                    enum: [NotRunning, Starting, Running, Stopping, Stopped]
                  extension:
                    type: object
                    properties:
                        thermic:
                          type: object
                          properties:
                            coolant:
                              allOf:
                                - description: Engine coolant liquid properties.
                                - $ref: '#/components/schemas/EngineLiquid'
                            oil:
                              allOf:
                                - description: Engine oil properties.
                                - $ref: '#/components/schemas/EngineLiquid'
                            scr:
                                description: Selective catalytic reduction (SCR) system warning level.
                                type: string
                                enum: [ Off, Blinked, On]  

    Engine:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'
            - $ref: '#/components/schemas/EngineBase'
        
    Propulsion:
     allOf:
      - $ref: '#/components/schemas/CreatedAtField'
      - $ref: '#/components/schemas/PropulsionBase'
    PropulsionBase:
      description:  >
          Vehicle propulsion system includes one or more sources of propulsion, which can be used together or alternately. During a driving session, a vehicle can switch from one propulsion mode to another. This structure therefore expresses the mode of propulsion at a given time stamp.
            
            * _Note: For the electric vehicle, the propulsion type will always be electric. Similarly, for thermal vehicle, it will always be thermal._
      properties:
          type:
                type: string
                description: Propulsion type. It depends on the vehicle propulsion papabilities.
                enum: [Thermal, Electric, Hybrid]
    
    
    MaintenanceBase:
          description: Expresses next Maintenance destails. Such as number of days and the
            mileage (km) till the next Maintenance.
          type: object
          title: Maintenance
          properties:
            daysBeforeMaintenace:
              type: integer
            mileageBeforeMaintenance:
              type: integer
              
    Maintenance:
      allOf:
          - $ref: '#/components/schemas/CreatedAtField'
          - $ref: '#/components/schemas/MaintenanceBase'
         
    Ignition:
        allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - $ref: '#/components/schemas/IgnitionBase'
        
    IgnitionBase:
          type: object
          properties:
            type:
                type: string
                enum: [Stop, StartUp, Start, Free]
          required: [type,createdAt]
  
           
    VehicleOdometer: 
      allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - type: object
          properties:
            mileage:
                  description: Vehicle mileage expressed in KM.
                  type: number
    TimeStamped:
      properties:
        createdAt:
              type: string
              format: date-time 
    
    AdasBase:  
                type: object
                properties:
                  parkAssist:
                    type: object
                    properties:
                      front:
                        type: array
                        items:
                          type: string
                          enum:
                            - Fault
                            - DriverInhibition
                            - Active
                            - Wait
                            - OutOfService 
                      rear:
                        type: array
                        items:
                          type: string
                          enum:
                            - Fault
                            - DriverInhibition
                            - Active
                            - Wait
                            - OutOfService 
                  accr:
                    description: Adaptive Cruise Control Regulation
                    type: string
                    enum:
                      - Activated
                      - Fault
                      - Hold
                      - HoldWithOverSpeeding
                      - Off
                  lvv:
                    type: boolean
                  rvv:
                    type: string
                    enum:
                      - off
                      - Inactive
                      - Active
                      - SpeedExceeded
                      - Disabled
                      - DisabledBySystem
                      - MaxSpeedExceed
                      - SpeedDeltaExceed
                      - ReducedVisibility
                      - Learning
                  aebs:
                    description: Advanced Emergency Braking System
                    type: string
                    enum:
                      - off
                      - Fixed
                      - OnFlashing
                  afil:
                    description: Lane Departure Warning System
                    type: string
                    enum: [FlashingFault, FlashingWarning, Off, OnFixed]
                  artiv:
                    description: Respect of inter vehicle time assist (ARTIV)
                    type: string
                    enum:
                      - NotSelected
                      - Selected
                      - Unavailable
                    default: Unavailable
                  bsm:
                    description: Blink SpotMonitoring
                    type: string
                    enum:
                      - Active
                      - Inactive
                      - Disabled
                  esp:
                    description: Electronic Stability Programme
                    type: boolean
                  abs:
                    description: Anti-lock braking system
                    type: boolean
                  fse:
                    description: Electric brake service
                    type: boolean
                  sli:
                    description: Speed Limit Information
                    type: integer
                  rlka:
                    description: Lane Keeping Assist right
                    type: string
                    enum: [Authorized, CorrectionInProgress, NotAuthorized, NotSelected]
                  lrka:
                    description: Lane Keeping Assist left
                    type: string
                    enum: [Authorized, CorrectionInProgress, NotAuthorized, NotSelected]
    Adas:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'
            - $ref: '#/components/schemas/AdasBase'           
    LightingBase:  
                type: object
                properties:
                  turn:
                    type: array
                    items:
                      type: string
                      enum: [Left, Right]
                  light:
                    type: array
                    items:
                      type: string
                      enum: [Front, Rear]
    Lighting:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'  
            - $ref: '#/components/schemas/LightingBase'
         
    
          
    BasicKinetic:
            description: |
                          Everything related to the movement of the vehicle. Speed, acceleration..
                            * _Disclaimer_:  ```speed``` or ```acceleration``` (fileds) are never returned at the same time as the odometer (even if compounded with another data object)
#                            
            properties:
                acceleration:
                  type: number
                  format: float
                  description:  Vehicle acceleration (expressed in m/s²)
                speed:
                  type: number
                  format: float
                  description:  Vehicle speed (expressed in m/s)
                pace:
                  description:  Vehicle pace (expressed in m/s)
                  type: number
                  format: float
                moving:
                  type: boolean 
    
    Kinetic:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'
            - $ref: '#/components/schemas/BasicKinetic'    
                  
    BrakingSystemBase:
              type: object
              properties:
                parking:
                  type: boolean        
    BrakingSystem:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'
            - $ref: '#/components/schemas/BrakingSystemBase'    
    
    TransmissionBase:
              type: object
              properties:
                gearbox:
                  type: object
                  properties:
                    gear:
                      type: object
                      properties:
                        recommended:
                          type: string
                          enum:
                            - None
                            - Up
                            - Down
                            - UpDown
                    mode:
                      type: object
                      properties:
                        automatic:
                          type: boolean
                        sport:
                          type: boolean
                        snow:
                          type: boolean                 
    Transmission:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'
            - $ref: '#/components/schemas/TransmissionBase'
    DrivingBehaviorBase:
        type: object
        properties:
            mode:
                description : Driving mode by driver selection
                type : string
                enum:
                    - Normal
                    - Sport
                    - Confort
                    - Eco
                    - Sand
                    - Mud
                    - Snow
                    - ZEV
                    - Hybrid
                    - ZEVEco
                    - HybridEco
                    - EcoPlus
                    - eAWD
                    - 4AWD
                    - ReinforcedLoad
    DrivingBehavior:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'
            - $ref: '#/components/schemas/DrivingBehaviorBase'                 
    Privacy:
      allOf:
                - $ref: '#/components/schemas/CreatedAtField'
                - type: object
                  properties:
                    state:
                      type: string
                      enum: [None, Geolocation, Full]
    Battery:  
           allOf:
              - $ref: '#/components/schemas/CreatedAtField'
              - $ref: '#/components/schemas/BatteryBase'
              
    BatteryBase:  
                description: Describe the car (with combustion engine)  battery status.
                type: object
                properties:
                  voltage:
                    type: number
                    format: float
                  current:
                    type: number
                    format: float
    Safety:
           allOf:
              - $ref: '#/components/schemas/CreatedAtField'
              - type: object
                properties:
                  beltWarning:
                    type: string
                    enum: [Normal, Omission]
                  autoECallTriggering:
                    type: string
                    enum: [NotDetected, Detected]     
    ServiceType:
      type: object
      properties:
        updatedAt:
          type: string
          format: date-time
        type:
          type: string
          enum: [Electric, Hybrid, Unknown]
      
    
    DoorsState:
        allOf:
          - $ref: '#/components/schemas/UpdatedAtField'
          - $ref: '#/components/schemas/DoorsStateBase'
                        
    DoorsStateBase:
            type: object
            properties:
                lockedState:
                  type: string
                  enum: [Unlocked, Locked, SuperLocked, DriverDoorUnlocked, CabinDoorsUnlocked, CargoDoorsLocked, CargoDoorsUnlocked, RearDoorsUnlocked, RearDoorsLocked, TrunkLocked, TrunkUnLocked]
                opening:
                  type: array
                  items:
                    type: object
                    description: Opening state per door.
                    properties :
                      identifier: 
                        type: string
                        enum: [Driver, Passenger, RearLeft, RearRight, Trunk, RearWindow, RoofWindow]
                      state:
                        type: string
                        enum: [Open, Closed] 
          
    AggregatedTelemetries:
      allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - $ref: '#/components/schemas/UpdatedAtField'
        - title: AggregatedTelemetry
          description: Describe the latest aggregated Telemetries of the vehicule such latest location, ignition state, doors openeing state ...etc.
          type: object
          properties:
            _links:
              type: object
              properties:
                self:
                  $ref: '#/components/schemas/link'
                vehicle:
                  $ref: '#/components/schemas/link'
            vehicle:
              properties:
                ignition:
                      $ref: '#/components/schemas/Ignition'
                location:
                      $ref: '#/components/schemas/Position'
                preconditioning:
                      $ref: '#/components/schemas/Preconditioning'
                energies:
                      $ref: '#/components/schemas/Energies'
                engines:
                      $ref: '#/components/schemas/Engines'
                doorsState:
                      $ref: '#/components/schemas/DoorsState'
                battery:
                      $ref: '#/components/schemas/Battery'
                service:
                      $ref: '#/components/schemas/ServiceType'
                safety:  
                      $ref: '#/components/schemas/Safety'
                odometer: 
                      $ref: '#/components/schemas/VehicleOdometer'
                kinetic :
                      $ref: '#/components/schemas/Kinetic'
                propulsion:
                      $ref: '#/components/schemas/Propulsion'
                braking:
                      $ref: '#/components/schemas/BrakingSystem'
                transmission:
                      $ref: '#/components/schemas/Transmission'
                adas:
                      $ref: '#/components/schemas/Adas'
                lighting:
                      $ref: '#/components/schemas/Lighting'
                maintenance:
                      $ref: '#/components/schemas/Maintenance'
                activeAlerts:
                     $ref: '#/components/schemas/ActiveAlerts'
                drivingBehavior:
                      $ref: '#/components/schemas/DrivingBehavior'
                alarm:
                      $ref: '#/components/schemas/VehicleStatusAlarm'
                
            privacy:
                  $ref: '#/components/schemas/Privacy'
            environment: 
                  $ref: '#/components/schemas/Environment'
              
          required:
            - _links 
        
    Vect2D:
      description:  This is a simple 2 (or more) number vector used to define Geometry
        objects.
      type: array
      items:
        type: number
        minItems: 2
    Geometry:
      title: Geometry
      type: object
      description: This object expresses the Geometry as specified by
        [rfc7946](https://tools.ietf.org/html/rfc7946#section-3.1). It is also
        the root of the Geometry objects (Point, cicle, poygon)
      properties:
        type:
          type: string
          enum:
            - Polygon
            - Point
            - ExtCircle
        coordinates:
          title: Coordinates
          description: Geometry coordinates
      externalDocs:
        url: 'https://tools.ietf.org/html/rfc7946#section-3.1'
      required:
        - coordinates
        - type
    Point:
      allOf:
        - $ref: '#/components/schemas/Geometry'
        - title: Point
        - description: This object expresses a GeoJSON Point as specified by
            [rfc7946](https://tools.ietf.org/html/rfc7946#section-3.1.2).
          required: [type,coordinates]
          properties:
            type:
              type: string
              default: Point
              enum:
                - Point
            coordinates:
              description: This is a simple 2 (or more) numbers vector used to define Geometry
                Point object.
              type: array
              items:
                type: number
                format: float
                minItems: 2
          example: 
            type: Point
            coordinates:
              - 5.970338 
              - -62.536239
    PolygonZone:
      allOf:
        - $ref: '#/components/schemas/Geometry'
        - title: Polygon
          properties:
            type:
              default: Polygon
              enum:
                - Polygon
            coordinates:
              type: array
              minItems: 3
              items:
                $ref: '#/components/schemas/Vect2D'

    Position:
      allOf:
        - required:
            - geometry
            - properties
            - type
          type: object
          title: Position
          properties:
            type:
              type: string
              default: Feature
              enum:
                - Feature
            geometry:
              $ref: '#/components/schemas/Point'
            properties:
              type: object
              properties:
                updatedAt:
                  type: string
                  format: date-time
                createdAt:
                  type: string
                  format: date-time
                heading:
                  type: number
                  format: float
                  minimum: 0
                  maximum: 360
                signalQuality:
                    type: number
                    format: int
                type:
                  type: string
                  enum:
                    - Estimate
                    - Acquire
    Energies:
      type: array
      items: 
         $ref: '#/components/schemas/Energy'    
    Energy:
      allOf:
          - $ref: '#/components/schemas/UpdatedAtField'
          - $ref: '#/components/schemas/EnergyBase'
    EnergyBases:
      type: array
      items: 
         $ref: '#/components/schemas/EnergyBase' 
    EnergyBase:
                description: Describe vehicle energy supply for thermic, low emission vehicle or both.
                type: object
                properties :
                  type:
                    type: string
                    description: Energy type present on the vehicle.
                    enum: [Fuel, Electric]
                  subType:
                    type: string
                    description: | 
                      Energy subtype. This field is not mandatory and therefore if it is not present, it means that the resource consumer should only process the primary energy type. The enumeration of the subtypes is not exhaustive and may contain more elements depending on the evolution of the vehicles. The consumer of the data must take this constraint into account. The Fossil and Electric energy subtypes are only used to populate this subtype for the default Fuel and Electricity types.
                        * Electric and hydrogen vehicles energy types are considered as low emission energies whereas fuel(fossil) is associated to thermic energy
                    enum: [FossilEnergy, ElectricEnergy, Hydrogen]          
                  level:
                    type: number
                    format: float
                    minimum: 0
                    maximum: 100
                  autonomy:
                    description: Vehicle autonomy expressed in km for this energy class.
                    type: integer
                  extension:
                    type: object
                    properties:
                      fuel:
                        description: Specific fuel energy properties.
                        type: object
                        properties:
                           consumption:
                               $ref: '#/components/schemas/FuelEnergyInstantConsumption'
                      electric:
                        description: Specific electric energy parameters.
                        type: object
                        properties:
                          residual:
                             $ref: '#/components/schemas/ElectricResidualEnergy'
                          battery:
                            $ref: '#/components/schemas/EnergyBattery'
                          charging:
                            $ref: '#/components/schemas/EnergyCharging'
                          consumption:
                               $ref: '#/components/schemas/ElectricEnergyInstantConsumption'  


    
    Consumption:
          type: object
          properties:
              consumption:
                type: number
                format: float
                minimum: 0
          required: [consumption]
              
    EnergyInstantConsumption:
        allOf:
              - description: Instant consumption for vehicle for a type of energy. Expressed in L/100Km for fuel energy type or in KW/100Km for eletric one.
              - $ref: '#/components/schemas/Consumption'
              - properties:
                 type:
                    type: string
                    enum: [Fuel, Electric]
                  
    EnergyConsumption:
        allOf:
              - $ref: '#/components/schemas/Consumption'
              - description: Total consumption for vehicle for a type of energy. Expressed in L for fuel energy type or in KWh for eletric one.
              - properties:
                 type:
                    type: string
                    enum: [Fuel, Electric]
              - required: [type]      
                    
    FuelEnergyInstantConsumption:
        allOf:
              - description: Instant consumption for vehicles for fuel energy. Expressed L/100Km
              - $ref: '#/components/schemas/Consumption'
              
    ElectricEnergyInstantConsumption:
         allOf:
              - description: Instant consumption for vehicles for eletric energy. Expressed in KW/H
              - $ref: '#/components/schemas/Consumption'  
    FuelEnergyConsumption:
         allOf:
              - description: Total consumption for vehicles for fuel energy. Expressed in L
              - $ref: '#/components/schemas/Consumption'          
    ElectricEnergyConsumption:
         allOf:
              - description: Total consumption for vehicles for eletric energy. Expressed in KWh
              - $ref: '#/components/schemas/Consumption'             
    ElectricResidualEnergy:
         allOf:
              - description: Residual electric energy (KWh)
              - $ref: '#/components/schemas/Consumption'
                  
    EnergyCharging:
                  type: object
                  description: Electric battery capacity and heath
                  required: [status]
                  properties:
                    plugged:
                      type: boolean
                    status:
                      $ref: '#/components/schemas/ChargingStatusEnum'
                    remainingTime:
                      description: Remaning time before the battery is fully charged. This duration is expressed using [ISO8601](https://en.wikipedia.org/wiki/ISO_8601#Durations) format.
                      type: string
                    chargingRate:
                      description:  Charging speed (expressed in gained batteryLife per hour -> KM/H).
                      type: integer
                      minimum: 0
                      maximum: 500
                    chargingMode:
                        description:  The charging mode; Slow, Quick and No(not charging).
                        type: string
                        enum: [ No, Slow, Quick ]
                    nextDelayedTime:
                      description:  Duration (as defined in [RFC3339](https://www.ietf.org/rfc/rfc3339.txt)) until the next battery charging.
                      type: string
                      
    EnergyBattery:
              type: object
              description: Electric charging state.
              properties:
                capacity:
                  description: Electric battery total capacity (expressed in Wh). 
                  type: number
                  format: float
                health:
                  type: object
                  properties:
                    capacity:
                      description:  Health related to battery capacity (expressed in percentage).
                      type: number
                      format: int 
                    resistance:
                      description:  Health related to battery resistance (expressed in percentage).
                      type: number
                      format: int
         
    Program:
      type: object
      description: Describe recurring action.
      properties:
        recurrence:
            description: |
                      
                      Set the recurrence of the program. 
                      
                      * None: means no recurrence. 
                      
                      * Daily: repeated over the week.

#                      
            type: string
            enum: [None, Daily]
            default: Daily
        start:
            type: string
            description: |
                          The program start time formatted using the duration format based on [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Time_intervals) with the schema: P[n]Y[n]M[n]DT[n]H[n]M[n]S
                      
                          _example_: 
                        
                          * PT14H30M :  14H30min
#                          
        occurence:
                type: object
                description: The occurrence on the program will spread on  weeks and days depending on recurrence value.
                properties:
                    day:
                        type: array
                        items:
                          type: string
                          enum: [Mon, Tue, Wed, Thu, Fri, Sat, Sun]
                    week:  
                        type: array
                        description: Set the weeks of the year the monitor will be active. If not set then the monitor will be active all weeks of the year.
                        items:
                        #week of year : w1, w2 ... w34-w46 ..
                          type: string
                          format: w[1-5]([0-9])*(-w[1-5]([0-9])*)?
                        example: 
                          - w1
                          - w5-w9
                          - w10
                          - w50-w52
                                  
                required: [day]
     # required: [start, recurrence, occurence]

    
    ExtensionType:
      type: array
      items:
        type: string
        enum:
          - location
          - alerts
          - collision
          - maintenance
          

          
    StatusExtensionType:
      type: array
      items:
        type: string
        enum:
          - odometer
          - kinetic
          
    Extension:
      type: object
      description: Additional data set.
      properties:
        odemeter:
          $ref: '#/components/schemas/VehicleOdometer'
        kinetic:
          $ref: '#/components/schemas/Kinetic'
    
    TelemetryExtension:
        allOf:
          - description: Additional data set for telemetry.  
          - properties:
                odometer: 
                    type: object
                    properties:
                      mileage:
                            description: Vehicle mileage expressed in KM.
                            type: number
                            format: float
                kinetic :
                      $ref: '#/components/schemas/BasicKinetic'
                location:
                      $ref: '#/components/schemas/Position'
                maintenance:
                       $ref: '#/components/schemas/MaintenanceBase'

    PreconditioningProgram:
      allOf:
        - $ref: '#/components/schemas/Program'
        - title: ProconditionProgram
        - properties:
            enabled:
                type: boolean
                description:  Determines whether this program is enabled or not.
            
            slot:
              description: The preconditionning program number.
              type: number
              format: int
              
        - required: [enabled,start, occurence,recurrence]
        
    TimeTriggerEntry:
      allOf:
        -  $ref: '#/components/schemas/Program'
        - description: |
                        The monitor Time Trigger Entry that specifies the start (relative or absolute) and duration of the time interval. The relative start time must be to midnight and the absolute must be expressed in UTC.
                        
                        <u><b>Note:</b></u> 
                        * ```recurrence``` field <b><u>should</u></b> be provided only if the recurrence is set to ```Daily```. Otherwize and invalid parameter status is returned.
                        * The time entry with recurrence set to ```None``` means that this program will be enabled from the absolute start time and the ```recurrence``` will not be accepted. This kind of time entry can be used to for delayed monitor activation (from a start time).
                        *  ```duration``` field <b><u>is mandatory</u></b> if the recurrence is set to ```Daily```. If it is set to ```None``` then it will define the absolute monitor activity period duration (starting from absolute time defined by ```start``` field), otherwise this trigger time interval is considered as unclosed.
#                        
          properties:
            duration:
              description: Duration of the monitor action expressed using [ISO-8601 Duration spec](https://en.wikipedia.org/wiki/ISO_8601#Durations).  This field <b><u>is mandatory</u></b> if the recurrence is set to ```Daily```
              type: string
            start:
              type: string
              description: |
                            The start time.
                            Its format depends on the occurence value.
                            * For ```None``` occurence, the start time is considered as absolute time from when the monitor can trigger events. In this case the format should be compliante with [RFC3339](https://www.ietf.org/rfc/rfc3339.txt)  
                            
                              _example_: 2018-01-03T12:00:00+01:00
                            * For ```Daily``` the start time formatted using the duration format based on [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Time_intervals) with the schema: P[n]Y[n]M[n]DT[n]H[n]M[n]S and whose value is between 00H and 23h59
                        
                              _example_: PT14H30M : means 14H30min
          
                            
                          
                          
#                          
          required: [start]
    PreconditioningBase:
      type: object
      description: Preconditionning the vehicle for driver and passenger.
      properties:
        airConditioning:
          type : object
          
          properties:

            status:
              description: The status of the preconditionning feature.
              type: string
              enum: [Enabled, Disabled, Finished, Failure]
            failureCause:
              description: failure cause
              type: string
              enum: [ Defect, DoorOpened, LowBattery, LowFuelLevel, TooManyUnusedProg ]
            programs:
              type: array
              items:
                $ref: '#/components/schemas/PreconditioningProgram'          
    Preconditioning:
      allOf:
          - $ref: '#/components/schemas/CreatedAtField'
          - $ref: '#/components/schemas/PreconditioningBase'
                    

            
            
            
             #*  *2018-01-03T12:00:00+01:00/*  known low limit, hight limit = current time.
            
          #  *  *R5/2018-01-03T12:00:00Z/P6H* repeate duration 6H interval for 5 times starting at 2018-01-03T12:00:00Z.  
        

          
    Environment: 
              type: object
              properties:
                  luminosity:
                     $ref: '#/components/schemas/Luminosity'
                  air:
                     $ref: '#/components/schemas/Air'
    EnvironmentBase: 
              type: object
              properties:
                  luminosity:
                     $ref: '#/components/schemas/LuminosityBase'
                  air:
                     $ref: '#/components/schemas/AirBase'
    Luminosity:
                    allOf:
                      - $ref: '#/components/schemas/CreatedAtField'
                      - $ref: '#/components/schemas/LuminosityBase'
    LuminosityBase:
                    allOf:
                      - $ref: '#/components/schemas/CreatedAtField'
                      - type: object
                        properties:
                          day:
                            type: boolean 
    Air:
                    allOf:
                      - $ref: '#/components/schemas/CreatedAtField'
                      - $ref: '#/components/schemas/AirBase'
    AirBase:
                        type: object
                        properties:
                          temp:
                            type: number     
    Trip: 
      allOf:
            - $ref: '#/components/schemas/UpdatedAtField'
            - $ref: '#/components/schemas/CreatedAtField'
            - title: Trip 
              type: object
              properties:
                _links:
                  type: object
                  properties:
                    self:
                      $ref: '#/components/schemas/link'
                    vehicle:
                      $ref: '#/components/schemas/link'
                    waypoints:
                      $ref: '#/components/schemas/link'
                    alerts:
                      $ref: '#/components/schemas/link'
                id:
                  type: string
                  description: Identifier of a trip
                createdAt:
                  type: string
                  format: date-time
                updatedAt:
                  type: string
                  format: date-time                  
                startedAt:
                  type: string
                  format: date-time
                  description: Date & Time when the trip started
                stoppedAt:
                  type: string
                  format: date-time
                  description: Date & Time when the trip stopped
                duration:
                  type: string
                  description: Duration of the trip
                distance:
                  type: number
                  format: float
                  description: Distance in km of the trip
                energyConsumptions:
                  description: The consumptions of different energies during this trip.
                  type: array
                  items: 
                     $ref: '#/components/schemas/EnergyConsumption'
                propulsionParts:
                  description: The parts of the trip crossed for each type of propulsion present on the vehicle.
                  type: array
                  items:
                    allOf:
                     - $ref: '#/components/schemas/PropulsionBase'
                     - properties:
                          percent: 
                            description: The part of the trip traveled in this type of propulsion expressed as a percentage.
                            type: number
                            format: float
                            minimum: 1
                            maximum: 100
                    
                startPosition:
                  $ref: '#/components/schemas/Position'
                stopPosition:
                  $ref: '#/components/schemas/Position'
                done:
                  description: Determines whether this trip is finished or not.
                  type: boolean
                faults:
                  description: The faults of this finished or in progress trip. This means that we lacked data from the vehicle to complete the trip description during one of its step (starting, progressing, or finishing).
                  type: array
                  items:
                    type: object
                    properties:
                      fault:
                        type: string
                        enum: [Unstarted, DataLacking, Unfinished]
                      cause:
                        type: string
                        enum: [GeoPrivacy, FullPrivacy, Connection]
    Vehicle: 
      allOf:
            - title: Vehicle Information
              type: object
              properties:
                _links:
                  type: object
                  properties:
                      self:
                        $ref: '#/components/schemas/Link' 
                      lastTelemetries:
                        $ref: '#/components/schemas/Link'
                      telemetries:
                        $ref: '#/components/schemas/Link'
                      collisions:
                        $ref: '#/components/schemas/Link'
                      trips:
                        $ref: '#/components/schemas/Link'
                      maintenance:
                        $ref: '#/components/schemas/Link'
                      alarms:
                        $ref: '#/components/schemas/Link'
                      alerts:
                        $ref: '#/components/schemas/Link'
                      remotes:
                        $ref: '#/components/schemas/Link'
                      groups:
                        type: array
                        minItems: 1
                        items:
                            $ref: '#/components/schemas/Link'
                id:
                  type: string
                vin:
                  description: Unique vehicle identifier number
                  type: string
                brand:
                  description: Brand of a vehicle
                  type: string
                engine:  
                  description: Engine of a vehicle
                  type: array
                  items:
                    type: object
                    properties:
                      description:
                        description: Engine description ( name, version...). texte is rendered using the 'local' query parameter.
                        type: string
                      class:
                        type: string
                        default: Thermic
                        enum:
                          - Thermic
                          - Electric
                      fuelTye:
                        description: Type of fuel of the engine (Not available for Electric class)
                        type: string
                        enum:
                          - GPL
                          - Gasoil
                          - Petrol
                          - Biologic
                label:
                  description: Version of a vehicle
                  type: string
                pictures:
                  description: Link to a vehicle picture. 
                  type: array
                  minItems: 1
                  maxItems: 12
                  items:
                    $ref: '#/components/schemas/Url' 
            - $ref: '#/components/schemas/UpdatedAtField'
            - $ref: '#/components/schemas/CreatedAtField'
    Alerts:
      title: Alerts Array
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                alerts:
                  type: array
                  items:
                    $ref: '#/components/schemas/Alert'

    Collisions:
      title: Vehicle Collisions array
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                Collisions:
                  type: array
                  items:
                    $ref: '#/components/schemas/Collision'
  
    WayPoints:
      description: WayPoints of a Trip response
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                positions:
                  type: array
                  items:
                    $ref: '#/components/schemas/Position'
              required:
                  - positions
                  
                  
    Telemetry:
        allOf:
            - $ref: '#/components/schemas/CreatedAtField'
            - type: object
              properties:
                _links:
                  type: object
                  properties:
                    self:
                      $ref: '#/components/schemas/Link'
                    vehicle:
                      $ref: '#/components/schemas/Link'
                    trip:
                      $ref: '#/components/schemas/Link'
                privacy:
                  $ref: '#/components/schemas/Privacy'
                vehicle:
                  type: object
                  properties:
                    ignition:
                       $ref: '#/components/schemas/IgnitionBase'
                    location:
                          $ref: '#/components/schemas/Position'
                    preconditioning:
                          $ref: '#/components/schemas/PreconditioningBase'                          
                    energies:  
                      $ref: '#/components/schemas/EnergyBases'
                    engines:
                      $ref: '#/components/schemas/EngineBases'
                    doorsState:
                      $ref: '#/components/schemas/DoorsStateBase'  
                    battery:
                      $ref: '#/components/schemas/BatteryBase'
                    safety:  
                        type: object
                        properties:
                          beltWarning:
                            type: string
                            enum: [Normal, Omission]
                          eCallTriggeringRequest:
                            type: string
                            enum: [AirbagUnabled, NoRequest, Requested]
                    odometer: 
                        type: object
                        properties:
                          mileage:
                                description: Vehicle mileage expressed in KM.
                                type: number
                                format: float
                    kinetic :
                        $ref: '#/components/schemas/BasicKinetic'
                    propulsion:
                        $ref: '#/components/schemas/PropulsionBase'
                    braking:
                      $ref: '#/components/schemas/BrakingSystemBase'
                    transmission:
                      $ref: '#/components/schemas/TransmissionBase'
                    adas:
                      $ref: '#/components/schemas/AdasBase'
                    lighting:
                      $ref: '#/components/schemas/LightingBase'
                    maintenance:
                          $ref: '#/components/schemas/MaintenanceBase'
                    drivingBehavior:
                       allOf:
                          - description: Describe the behavior of the driver
                          - $ref: '#/components/schemas/DrivingBehaviorBase'
                    activeAlerts:
                          $ref: '#/components/schemas/ActiveAlertsBase'
                    alarm:
                        $ref: '#/components/schemas/BaseAlarm'



                environment:
                  $ref: '#/components/schemas/EnvironmentBase'

    
    Telemetries:
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                telemetries:
                  type: array
                  items:
                    $ref: '#/components/schemas/Telemetry'

          
    TelemetryExtensionType:
      type: array
      minItems: 1
      maxItems: 4
      items:
        type: string
        enum:
          - location
          - maintenance
          - odometer
          - kinetic
    Trips:
      title: Trips
      description: List of a Trips response
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - description: List of a Trips response
          properties:
            _links:
              $ref: '#/components/schemas/Tab_Links'
            total:
              type: integer
            totalPage:
              type: integer
            currentPage:
              type: integer
            _embedded:
              type: object
              properties:
                trips:
                  type: array
                  items:
                    $ref: '#/components/schemas/Trip'
    Vehicles:
      title: Vehicle Information
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - title: Vehicle List
          properties:
            _embedded:
              type: object
              properties:
                vehicles:
                  type: array
                  items:
                    $ref: '#/components/schemas/Vehicle'
                

    url:
      type: string
      description: URL format follows [RFC 3986](https://tools.ietf.org/html/rfc3986) and
        usually looks like this ` scheme://host[:port][/Path] `
    link:
      type: object
      description: A Link Object as defined by [JSONHAL#Link
        Object](https://tools.ietf.org/html/draft-kelly-json-hal-08#section-5).
      required:
        - href
      properties:
        href:
          $ref: '#/components/schemas/url'
        templated:
          type: boolean
          description:  SHOULD be true when the Link Object's "href"   property is a URI
            Template
        type:
          type: string
          description:  a hint to indicate the media type  expected when dereferencing the
            target resource.
        deprecation:
          allOf:
            - $ref: '#/components/schemas/url'
            - description: indicates that the link is to be deprecated (i.e. removed) at a
                future date.  Its value is a URL that SHOULD provide further
                information about the deprecation.
        name:
          type: string
        title:
          type: string
          description: Its value is a string and is intended for labelling the link with a
            human-readable identifier (as defined by
            [RFC5988](https://tools.ietf.org/html/rfc5988)).
        profile:
          type: string
          description: Its value is a string and is intended for indicating the language of
            the target resource (as defined by [RFC5988]).
        hreflang:
          type: string
          description: Its value is a string which is a URI that hints about the profile
            (as defined by
            [I-D.wilde-profile-link](https://tools.ietf.org/html/draft-kelly-json-hal-08#ref-I-D.wilde-profile-link))
            of the target resource.
    tab_links:
      description: >
        [HAL](https://en.wikipedia.org/wiki/Hypertext_Application_Language#Convention)
        (Hypertext Application Language) link collection
#        
      type: object
      properties:
        self:
          $ref: '#/components/schemas/link'
        first:
          $ref: '#/components/schemas/link'
        next:
          $ref: '#/components/schemas/link'
        prev:
          $ref: '#/components/schemas/link'
        last:
          $ref: '#/components/schemas/link'
    ChargingStatusEnum:
      description: status of charging system.
      type: string
      enum:  [Disconnected, InProgress, Failure, Stopped, Finished]      
    AlertMsgEnum:
      type: string   
      description: Alert list 
      enum:
            - AbsBrakingSystemFault    
            - ActiveSpoilerFault    
            - AdBlueFault     
            - AdBlueFaultStartingImpossible   
            - AdBlueFaultStartingImpossibleSoon  
            - AddWasherFluid     
            - AirbagOrSeatBeltPretensionerOrActiveHoodFailure 
            - AssistanceButtonFault    
            - AutomaticBrakingDeactivated   
            - AutomaticHeadlightAdjustmentFault   
            - BatteryChargeOrElectricalCircuitSystemFailure 
            - BrakingSystemFailure    
            - ChargingFailure     
            - CheckTheCenterBrakeLamp    
            - CollisionDetectionSystemFault   
            - CollisionMitigationSystemFault   
            - CoolantLevellow     
            - DrivingAssistanceSensorBlind   
            - ElectricTractactionSystemFailureLimitSpeed
            - ElectricTractactionSystemFailureStopVehicle
            - ElectricTractionSystemFault    
            - ElectronicImmobiliserFault    
            - EmissionSystemOrAdBlueQualityFailueStartingImpossible
            - EmissionSystemOrAdBlueQualityFailueStartingImpossibleSoon
            - EmissionSystemOrAdBlueQualityFailure  
            - EngineFailure     
            - EngineFault
            - EngineMisfiringFuel
            - EngineOilPressureFailure    
            - EngineTemperatureFailure    
            - EspAsrSystemFault     
            - FrontLeftFlashingIndicatorFault   
            - FrontLeftFogLampsFault     
            - FrontLeftParkingLampsFault     
            - FrontRightFlashingIndicatorFault   
            - FrontRightFogLampsFault     
            - FrontRightParkingLampsFault     
            - FuelLevelLow     
            - GearboxFault     
            - HeadlightsFault     
            - InstalledSpareWheelFault   
            - InterVehicleTimeMeasurementFault  
            - LaneChangeAssistanceFault     
            - LaneDepartureWarningSystemFault   
            - LeftBrakeLampFault  
            - LeftFrontDoorOpen     
            - LeftFrontDoorOpenLowSpeed 
            - LeftFrontTirePressurSensorFault   
            - LeftFrontTirePuncture    
            - LeftFrontTireUnderInflated    
            - LeftRearDoorOpen     
            - LeftRearDoorOpenLowSpeed
            - LeftRearTirePressurSensorFault   
            - LeftRearTirePuncture    
            - LeftRearTireUnderInflated    
            - LeftReverseLampFault     
            - OilLevelLow      
            - ParkAssistSystemFault    
            - ParkingBrakeOrHillStartSystemFailure  
            - ParticleFilterAdditiveLevelTooLow   
            - ParticleFilterFull     
            - ParticleFilterRegenerating    
            - PowerSteeringFailure    
            - PowerSteeringFault    
            - PreheatingPreventilationDeactivatedBatteryLow 
            - PreheatingPreventilationDeactivatedClockUnset 
            - PreheatingPreventilationDeactivatedFuelLevelLow 
            - RearLeftFlashingIndicatorFault   
            - RearLeftFogLampsFault     
            - RearLeftParkingLampsFault     
            - RearRightFlashingIndicatorFault   
            - RearRightFogLampsFault     
            - RearRightParkingLampsFault     
            - RearWindowOpen     
            - RearWindowOpenLowSpeed
            - ReplaceBrakePads     
            - ReplaceTheRemoteControlBattery   
            - RetractableRoofMechanismFault   
            - RightBrakeLampFault     
            - RightFrontDoorOpenLowSpeed    
            - RightFrontDoorpen     
            - RightFrontTirePressurSensorFault  
            - RightFrontTirePuncture    
            - RightFrontTireUnderInflated    
            - RightRearDoorOpen     
            - RightRearDoorOpenLowSpeed 
            - RightRearTirePressurSensorFault   
            - RightRearTirePuncture    
            - RightRearTireUnderInflated    
            - RightReverseLampFault     
            - RiskOfIce     
            - RoofOperationNotPossibleSpeedUnknown
            - RoofOperationNotPossibleTooHighTemp
            - ShiftToPark     
            - SteeringLockFault     
            - SuspensionFault     
            - SuspensionFaultLimitSpeed
            - SuspensionFaultRepaireVehicle
            - TireUnderInflationDetectionSystemFault  
            - TireUnderInflationDetectionSystemFault  
            - TooManyRoofOperation
            - TrailerConnectionFault    
            - TrunkOrHoodOpen     
            - TrunkOrHoodOpenLowSpeed
            - WaterInTheDieselFuelFilter  

  
    TelemetryEnum:
      type: array
      minItems: 1
      maxItems: 10
      items:
        type: string
        enum:
          - environment
          - privacy
          - vehicle
          - vehicle.ignition
          - vehicle.location
          - vehicle.preconditioning
          - vehicle.energies
          - vehicle.engines
          - vehicle.doorsState
          - vehicle.battery
          - vehicle.safety
          - vehicle.odometer
          - vehicle.kinetic
          - vehicle.propulsion
          - vehicle.brakingSystem
          - vehicle.transmission
          - vehicle.adas
          - vehicle.lighting
          - vehicle.maintenance
          - vehicle.activeAlerts
          - vehicle.alarm.status
          - vehicle.alarm.trigger
    AlarmTypeEnum:
      type: array
      items:
        type: string
        enum:
          - vehicle.alarm.status
          - vehicle.alarm.trigger
    xError:
      type: object
      description: Detailed error
      properties:
        code:
          type: integer
        debug:
          type: string
        message:
          type: string
      example:
        code: 1001
        debug: CMP_001234
        message: No data availble for such context.
        
    UpdatedAtField:
     type: object
     properties:
       updatedAt:
          description: Date when the resource has been updated.
          type: string
          format: date-time
  
    CreatedAtField:
       type: object
       properties:
          createdAt:
            description: Date when the resource has been created.
            type: string
            format: date-time      
    MonitorId:
      type: string
      description: Uniq monitor ID returned when the monitor was created succefully.    
    Attribute:
            type: object
            properties:
              type:
                type: string
                enum: [Header, Body, Query]
                description: |
                  3 attributes type:
                  
                  |Attribute-type|Role|
                  |----------|-------------|
                  |Header|-Will be add as http header extension "x-######:"|
                  |Body|-Will be simply add to event body map attribute (see monitor event definition in template document)|
                  |Query|-Will set as http query parameter when invoking the Webhook|
#                  
              key:
                type: string
              value:
                oneOf:
                  - type: string
                  - type: string
                    enum: [Vin,ChannelId,channelLabel]
                    description: |
                      A value  that will be associated with the provided key as is if expressed as literal value or  contextually valued if prefixed with the dollar sign ($).  
                      
                      * example: Having a vin=VIN123456, the following attribute set:
                              ```"attributes": [
                                  {
                                    "type": "Header",
                                    "key": "X-vehicle-id"
                                    "value":"$vin"
                                  }
                                ]```
                        will be valued as http header extension: 
                                
                        *"X-vehicle-id: VIN123456"*
#                        
            required:
              - key
              - value  
              - type
            example:
              
              type: Header
              key: X-Vehicle_Id
              value: $vin
              
    AttributeSet:          
          type: array
          description: Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as a header enhancement (such as headers can be used as an authentication parameter when posting the event) or simply added to the notification event body (as set of key/values) or finally as additional query parameters.
          items:
            $ref: '#/components/schemas/Attribute'



    WSAttribute:
      allOf:
        - $ref: '#/components/schemas/Attribute'
        - properties:
              type:
                type: string
                description: Websocket basic key/value available as body attribute only. 
                enum: [Body]
                default: Body
              
                        
    WSAttributeSet:          
          description:  Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as a paylod key/value map enhancement or simply added to the notification event body (as set of key/value).
          type: array
          items:
            $ref: '#/components/schemas/WSAttribute'
    
    PushNotifAttribute:
      allOf:
        - $ref: '#/components/schemas/Attribute'
        - properties:
              type:
                type: string
                description: Push notification basic key/value. The key should not be a reserved word ("from", "message_type", or any word starting with "google" or "gcm"). The header attribute are mapped to data key/value map. 
                enum: [Header,Body]
                default: Header
              value:
                oneOf:
                  - type: string
                    description: |
                         The key/value pair is included as is in the generic 'data' part of the notification If the key is not a reserved one and type is not ```Body```, otherwise, it  will be added as the the corresponding field of the [push-notification spec](https://firebase.google.com/docs/cloud-messaging/concept-options#customizing-a-message-across-platforms) of output message (at notification time).
                         
                        
                 
                            ## FCM  keywords:  
                             Those FCM keywords can be used to customize notification messages and then they will be used to customize the notification by Firebase.
                            > * _Those attribute keys are optional but should be provided with their valid values with the respect of the format (see the table below) if set._

                            | Key   |      Category      |  Description |  Format |
                            |----------|:-------------:|------:|------:| 
                            | title | iOS, Android and WebPush |Title of the notification|not empty string|
                            | body | iOS, Android and WebPush|The notification's body text|not empty string|
                            | image| iOS, Android and WebPush |URL of the image displayed in a notification |not empty URL string [RFC 3986](https://tools.ietf.org/html/rfc3986)  (scheme://host[:port][/Path]|
                            | sound | iOS, Android |Specifying the sound to play when the device receives the notification|not empty string|
                            | clickAction | Android|The action associated with a user click|not empty string|
                            | ttl | iOS, Android and WebPush|How long (in seconds) the message should be kept in FCM storage if the device is offline|not empty string: format $(int) - pattern '^\d+$'  |
                            | bodyLocKey | iOS and Android|The key to the body string in the app's string resources|not empty string|
                            | bodyLocArgs | iOS and Android |Variable string values to be used in place of the format specifiers in body_loc_key|not empty string. <b>Args are separated by comma (,) if several</b>|
                            | titleLocKey | iOS and Android |The key to the title string in the app's string resources |not empty string|
                            | bodyLocArgs | iOS and Android |Variable string values to be used in place of the format specifiers in title_loc_key. <b>Args are separated by comma (,) if several</b>|
                            | badge | iOS and Android |The value of the badge on the home screen app icon|not empty string (integer) format|
                            | icon | Android and WebPush |The notification's icon|not empty string format|
                            | tag | Android and WebPush |Identifier used to replace existing notifications in the notification drawer.|not empty string format|
                            *For more details of the FCM Apns, Android or Webpush message keys, refer to Firebase Google documentation.
                            
                  - type: string
                    enum: [Vin,CallbackID,CallbackLabel]
                    description: |
                      Set of variables that will be contextually valued and used as push notification data or body attribute value.

                      *To reference the variable, prefix its name with the dollar sign ($)*
                      
                     
                      * example: Having a vin=VIN123456, the following attribute set:
                              ```"attributes": [
                                  {
                                    "type": "Header",
                                    "key": "vehicle-id"
                                    "value":"$vin"
                                  }
                                ]```
                        will be valued at data map key/value: 
                                
                        {"vehicle-id: VF123456"}
#                        
    PushNotifAttributeSet:          
          description: Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as a paylod key/value map enhancement or simply added to the notification event body (as set of key/value).
          type: array
          items:
            $ref: '#/components/schemas/PushNotifAttribute'
    DQAttribute:
      allOf:
        - $ref: '#/components/schemas/Attribute'
        - properties:
              type:
                type: string
                description: | 
                  Websocket basic key/value available as body attribute only. 
                enum: [Body]
                default: Body
              
                        
    DQAttributeSet:          
          description: |
            Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as an additional key/value properties map enhancement or simply added to the notification event body (as set of key/value).
          type: array
          items:
            $ref: '#/components/schemas/DQAttribute'            
    ChannelAttributes:
      title: ChannelAttributes
      description: |
                    Additional attributes that will add to or replace the specific channel (pushnotif, webhook or websocket) ones when sending the event.
                            
                    * Note: Union attributes set. Only one of the following: pushnotif, webhook orwebsocket should be set and it should be consistent with the channel type to wich it is associated
      type: object
      properties:
        pushnotif:
          description: Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as a paylod key/value map enhancement or simply added to the notification event body (as set of key/value).
          type: array
          items:
            $ref: '#/components/schemas/PushNotifAttribute'
        webhook:
          description: Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as a header enhancement (such as headers can be used as an authentication parameter when posting the event) or simply added to the notification event body (as set of key/values) or finally as additional query parameters.
          type: array
          items:
            $ref: '#/components/schemas/Attribute'
        websocket:
          description: Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as a paylod key/value map enhancement or simply added to the notification event body (as set of key/value).
          type: array
          items:
            $ref: '#/components/schemas/WSAttribute'        
    BasicAttribute:
    
      allOf:
        - description: |
              Common basic attribute. Allowing to add a key/value map to a notification event when sending.
        - $ref: '#/components/schemas/Attribute'
        - properties:
              type:
                type: string
                description: | 
                 
                    
                          |type|Role|
                          |----------|-------------|
                          |Header|Will be add as channel header entry (x-###### for webhool channel or as data map key/value for push-notif).|
                          |Body|-Will be  added to event body map.|
                
                enum: [Header,Body]
#        
    RemoteAttribute:
      allOf:
        - $ref: '#/components/schemas/BasicAttribute'
        

        - properties:
        
              value:
                oneOf:
                  - type: string
                  - type: string
                    enum: [RemoteType, RemoteStatus, RemoteLabel] 
                    description: |
                      Set of variables that will be contextually valued and used as attribute value. To reference the variable, prefix its name with the dollar sign ($)  
                      
                     
                      * example: Having a vin=VIN123456, the following attribute set:
                              ```"attributes": [
                                  {
                                    "type": "Header",
                                    "key": "X-remoteType"
                                    "value":"$remoteType"
                                  }
                                ]```
                        will be valued as http header extension: 
                                
                        *"X-remoteType: Horn"*          
#        

    RemoteAttributeSet:          
        type: array
        description:  Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be used as notification header enhancement (such as headers can be used as an authentication parameter when posting the event) or simply added to the notification event body (as set of key/values) or finally as additional query parameters(if supported).
        items:
            $ref: '#/components/schemas/RemoteAttribute'  
     
              
            
    MonitorAttribute:
      allOf:
        - $ref: '#/components/schemas/BasicAttribute'
        - properties:
              value:
                oneOf:
                  - type: string
                  - type: string
                    enum: [MonitorID, MonitorLabel] 
                    description: |
                      Set of variables that will be contextually valued and used as attribute value. To reference the variable, prefix its name with the dollar sign ($)  

                      * example: Having a vin=VIN123456, the following attribute set:
                              ```"attributes": [
                                  {
                                    "type": "Header",
                                    "key": "X-monitorID"
                                    "value":"$vin"
                                  }
                                ]```
                        will be valued as http header extension: 
                                
                        *"X-monitorID: 0123456"* 
#
    MonitorAttributeSet:          
        type: array
        description:  Additional and specific monitor attributes-set as key/value pairs wich will be added to the remote request when sending the event. Attributes will be added in addition to the basic attributes (from channel). 
        items:
            $ref: '#/components/schemas/MonitorAttribute'  
 
                        
    PushNotif:
      title: PushNotif
      description: |
        Defines the Push-Notification channel. This kind of channel distributes event messages to subscribed devices (Android or iOS). This push-notification feature is based on FCM (Firebase Cloud Messaging) and supports APNs (Apple Push Notification service) and GCM (Google Cloud Messaging for Android) notification channels.
        
        An attribute set (_attributes_) entry allows you to insert any convenient data (as _message.data_ feld of FCM message) into all events sent through this channel.
        
        _**Note**_: Basic notification template is used across all platforms.
                    
                    ```{
                      "name":string,
                      "data":{ 
                        string:string,
                        ...
                      },
                      "notification": {
                        object (Notification)
                      },
                    "token": string
                    }```
                    
          |Fields   |           |  
          |----------|:-------------:|
          |name|The identifier of the message to send|
          |data|Arbitrary key/value payload (filled from header attribut-set of channel and event)|
          |notification|Basic notification template(will expose the body of MPH event) |       
#      
      type: object
      properties:
        devices:
          description: List devices that will receive event messages.
          type: array
          minItems: 1
          items:
              type: string
        attributes:
          $ref: '#/components/schemas/PushNotifAttributeSet'
    Websocket:
      title: Websocket
      description: |
        Defines the websocket channel. This kind of channel distributes event messages in SI to SI way.  
        
        * An attribute set (_attributes_) entry allows you to insert any convenient data (as _message.data_ ) into all events sent through this channel. 
        * It is strongly recommended to always use WebSocket over TLS (_secure WebSocket_) for production environment.
        
        * For authentication purpose, login/pwd as part of url query string can be used as equivalent to  _basic authrntication_.
        * Both of ```ws``` and ```wss```  schemes are supported.
#        
      type: object
      properties:
        target:
          $ref: '#/components/schemas/Url'      
        attributes:
          $ref: '#/components/schemas/WSAttributeSet'
    Webhook:
      title: Webhook
      description: Defines the webhook for http notification. 
      type: object
      properties:
        retryPolicy:
          type: object
          description: The retry policy to apply when notification failed.
          required: [policy]
          properties:
            policy:
              type: string
              description:  Defines the retry rules following a notification failure (ie the return code is not HTTP 2XX for  WebHook mode). ```None``` means with a single try, ```Bounded``` with a limited number of tries. 
              enum: [None, Bounded]
            retryNumber:
                description: Maximum number of attempts (to be used with a retryPolicy set to ```Bounded```).
                type: integer
                default: 3
                minimum: 1
                maximum: 10
            retryDelay:
                description: Time to wait (expressed in seconds) befor retrying to push a notification (ignored if retryPolicy is set to ```None```).
                type: integer
                default: 60
                minimum: 20       
        target:
          $ref: '#/components/schemas/Url'
        name:
          type: string
          description: Webhook name.
        attributes:
          $ref: '#/components/schemas/AttributeSet'
      required:
        - target
        - name
      example:
        target: https://my.post.channel
        name: My_Webhook
        attributes:
                - type: Header
                  key: X-Vehicle_Id
                  value: $vin
    DataQueue:
        title: DataQueue
        description: |
          Defines an "on-the-fly" data queue callback. This type of callback dispatches event messages from SI to SI through an OEM queue broker. The queue is therefore associated with the partner who is known and who has subscribed to the Queue service..  
          
          * An attribute set (_attributes_) entry allows you to insert any convenient data (as _message.data_ ) into all events sent through this callback. 
          
        type: object
        properties:
          type:
                  type: string
                  description: Data Queue type. 
                  enum: [amqp]
                  default: amqp   
                  ## future use of array : mqtt ?
          attributes:
            $ref: '#/components/schemas/DQAttributeSet'            
    ChannelSubscribe:
      description: Channel subscription parameters.
      type: object
      properties:
        label:
          type: string
        type:
          allOf:
           - $ref: '#/components/schemas/SubscribeType'
           - description:  The supported types of subscription by this channel. If the field is not set then the channel will be eligible to accept all features. 
        channel:
          description: Union channel type can be only one of the following (pushnotif, webhook, websocket or dataqueue)
          type: object
          properties: 
            pushnotif:
              $ref: '#/components/schemas/PushNotif'
            webhook:
              $ref: '#/components/schemas/Webhook'
            websocket:
              $ref: '#/components/schemas/Websocket'
            dataqueue:
              $ref: '#/components/schemas/DataQueue'              
         
      required: [channel]
      
    
    
    
    RunStatus:
      type: string
      enum: [Running, Paused, Failed]
      
    RunStatusSetter:
      required: [status]
      properties:
          status:
            type: string
            enum: [Running, Paused]
            
            
    MonitorChannelSubscribe:
          description: "Monitor channel subscription extension. \n* Note: At least one of the parameters must be provided."
          type: object
          properties:
            refreshEvent:
                    description:  Define the period (in sec.) between two refresh events. The refresh events are sent when the condition of the monitor is satisfied(Trigger -> toggled true) after a period >= refresh time because the monitor triggering is conditioned by the vehicle activity and so its data availability . A kind of periodic reminder.
                    type: number
                    format: int32
                    minimum: 60
            channelAttributes:
              allOf:
                - description: |
                              Additional attributes that will be add to or replace the specific channel (pushnotif, webhook or websocket) ones when sending the monitor event.
                              
                              * Note: Union attributes set. Only one of the following: pushnotif, webhook orwebsocket should be set and it should be consistent with the channel type to wich this monitor is associated              
                - $ref: '#/components/schemas/ChannelAttributes'
 

      
    Monitor:
      allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - title: Monitor
          description: Monitor state object
          type: object
          properties:
            updatedAt:
              type: string
              format: date-time      
            _links:
              type: object
              properties:
                self:
                  $ref: '#/components/schemas/Link'
               
            monitorId:
              $ref: '#/components/schemas/MonitorId'
            monitor:
              $ref: '#/components/schemas/MonitorParameter'
            status:
              $ref: '#/components/schemas/RunStatus'
          required: [status,monitorId,monitor,createdAt,updatedAt]

    
    MonitorParameter:
      title: MonitorParameter
      description: |
                      MonitorParameter defines the vehicle monitor that will be used to detect the vehicle state transition. It defines state transition triggers, set of additional monitor attributes, extended event parameter (i.e. enrichment of monitor event from available vehicle data before sending) and an overload of the channel notification to which it is linked.
                      
                        However, it needs a set of necessary permissions for resources used for triggers and extended parameters:
                            
                        * This API has therefore defined a set of  OAuth 2.0 Scopes to cover all possible monitor definitions. But the user should grant only the necessary SCOPEs for the requested monitor.
                          
                        * Those Scopes are from the definitions of (if set) :
                            * <u>Zone</u> triggers. 
                            * <u>Data</u> triggers.
                            * <u>Extenstions</u>.
                            * <u>On event</u> actions.
      properties:
            label:
              type: string
              description: Monitor label (usually its name). 
            subscribeParam:
              $ref: '#/components/schemas/MonitorChannelSubscribe'
            onEvent:
                $ref: '#/components/schemas/OnMonitorEvent'          
            attributes:
              $ref: '#/components/schemas/MonitorAttributeSet'
            extendedEventParam:
              type: array
              items:
                 enum: [vehicle.status]
              description: |
                            Allow to set extra vehicle data (defined in data model) to add to the monitor event
                            when publishing. The possible values are :
                            
                            
                            |Value|Description|Related model |
                            |----------|:-------------|------:|
                            |vehicle.doorsState|Latest known door state (timestamped) before the eventDate|DoorState|
                            |vehicle.status|Latest known vehicle status (timestamped) before the eventDate|Status|
                            |vehicle.maintenance|Latest known maintenance(timestamped) before the eventDate|Maintenance|
                            |vehicle.position|Last vehicle position (timestamped) before the eventDate|Position|
                            |vehicle.telemetry${.TelemetryEnum} |Latest known telemetry (timestamped) before the eventDate filtered with type|Telemetry
                            |vehicle.alerts|List of active alerts at the eventDate|Alert|
                            |vehicle.alarm|Latest Vehicle alarm status and trigger|Alarm|

                            
                            * For telemetry extension:  
                              * The suffix ```${.TelemetryEnum}``` can be selected to refine with telemetry type (from the TelemetryEnum list). This value (with suffix) can be selected **_several times_** to included suitable telemetry messages with the extention.
                              * Using ```vehicle.telemetry``` without suffix means to include all available telemetries. 
#            
            triggerParam:
              description: Monitor trigger-param that allows to compound triggers by applying a boolean expression to evaluate them.
                             
              properties:
                          triggers:
                            description: |
                              Compound monitor triggers (will be evaluated using boolean expresion :```booExp```). At least, ```one``` trigger should be provided and at  most, ```five``` items are accepted.
                            type: array
                            minItems: 1
                            maxItems: 5
                            items:
                                $ref: '#/components/schemas/MonitorTrigger'      
                          boolExp:
                              type: string
                              description: |
                                A boolean expression that allow defining a logical relationship between triggers. Used Operands with this expression should be the names of the defined triggers. 
                                 
                                  _Note:_ Always ```true``` or Always```false``` expression are prohibited and will result with an http 400 error response.
                                  
                                  
                                Grammar:
                                ```
                                exp ::= exp '&' exp
                                       |exp '|' exp
                                       |(exp)
                                       |!exp
                                ```
                                
                                * **example**: having two-zone trigger (two towns) named z1 an z2, one time-trigger (8h00 to 20h00) named t1 and finally three data triggerd named as follow: f(fuel), a(autonomy) , o(odometer).
                                  
                                  we can have a boolean expression such as: : ``` ((z1 & t1) |(z2 & !t1) |(f & z1) |(a & (z1|t))  |(o & (z1 |z2))) ```
                              example :
                                ((z1 & t1) |(z2 & !t1) |(f & z1) |(a & (z1|t))  |(o & (z1 |z2)))
              required: [triggers,boolExp]
            

      required: [triggerParam,label]
    
    
    
  
    MonitorRef: 
      allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - type: object
          description: Monitor creation reference returned when posting a new monitor.
          required: [monitorId, status, createdAt, updatedAt]
          properties:
                updatedAt:
                  type: string
                  format: date-time
                _links:
                    type: object
                    properties:
                      monitor:
                        $ref: '#/components/schemas/Link'
                monitorId:
                  $ref: '#/components/schemas/MonitorId'
                status:
                  $ref: '#/components/schemas/RunStatus'
    MonitorStatusSetter:
      allOf:
        - $ref: '#/components/schemas/RunStatusSetter'
        - title: MonitorStatusSetter
          description: Monitor Status setter used to change the state from running to paused and vice versa. 
    HandleSetter:
          title: HandleSetter
          description: Handle group and vehicles set.
          required: [action]
          properties:
            action:
              type: string
              enum: [Add, Remove]
            groups:
              type: array
              items:
                $ref: '#/components/schemas/GroupId'
            vehicles:
              type: array
              items:
                type: string               
    MonitorTrigger:
      title: MonitorTrigger  
      description: Monitor trigger.```Only one```of *Zone, Time or Data* is supported at a time. Otherwise it would cause a bad request response.  
      properties:
        name: 
          description: 'The trigger name must be uniq and respect the following pattern'
          pattern: "\"[a-zA-Z]+[.-_]?[0-9]*\""
          type: string
        zone: 
             $ref: '#/components/schemas/ZoneTrigger'
        time: 
             $ref: '#/components/schemas/TimeTrigger'
        data: 
             $ref: '#/components/schemas/DataTrigger'     
      required: [name]  
                 
    ZoneTrigger:
      title: ZoneTrigger
      description: |
                    Zone Alert trigger object. 
                    
                    * Oauth2 scope for this trigger : <b>location</b>
      properties:
            transition:
              description: Zone monitoring type ('In' for monitoring entering zone and 'Out' for monitoring leaving zone),
              type: string
              enum:
                - In
                - Out
            place:
                    description: Circle zone is compound of a center point and a radius.
                    required:
                      - center
                      - radius
                    properties:
                      radius:
                        description: Circle radius (expressed in km)
                        type: number
                        format: int
                      center:
                        type: object
                        properties:
                          longitude:
                            type: number
                            format: double
                          latitude:
                            type: number
                            format: double
                        required: [longitude, latitude]
      required: [place, transition]
      example: 
                        transition: Out
                        place:
                          radius: 20
                          center:
                            longitude: 2.333333
                            latitude:  48.866667
    
    TimeTrigger:
      title: TimeTrigger
      description: | 
                    Temporal monitor for triggering vehicle activity event within a time interval.
                    
                    <b><u>Note:</u>
                    * If no data trigger is defined with this one then  <i>kinetic.moving</i> will be used by default and therefore the Oauth2 scope <b>telemetry:vehicle:kinetic</b> should be granted
      required: [times]
      properties:
            times:
              type: array
              items:
                $ref: '#/components/schemas/TimeTriggerEntry'
            timeZone: 
              type: string
              pattern: \w?/\w?
              default: Europe/Paris
              description: The standard time [zone code](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones) of the region where to apply this time trigger monitor. 
                  This allows to adapt this trigger to the time change according to local (region/country) criteria/rules.
              example: Europe/Paris
    
            
    DataTrigger:
      title: DataTrigger
      description: A monitor for triggering the vehicle data change event.
      properties:
        data:
          description: |
            The left operand of the trigger function. The following Table details for each operand data its type, the supported operator and the possibly retruned value with the necessary resource granted scope:
            
            |**Data**|**Type**|**Op**|**Value**|**oAuth2 scope**|
            |---|---| ---:| ---:|---:|
            |vehicle.alert |List of value |onChange (at least one)/includedIn/equalsTo |Value (ObjetAlert) |alert|
            |vehicle.alarm.trigger.type |List of value |onChange (at least one)/includedIn/equalsTo | Value(Alarm ID)|alarm|
            |vehicle.alarm.status.activation |Boolean |onChange/equalsTo | Value(Alarm ID)|alarm|
            |vehicle.odometer |Integer (signed) |equalsTo/greaterThan/lowerThan/ |Value |telemetry:vehicle:odometer|
            |vehicle.engines.running (boolean) |Boolean |onChange/equalsTo |Value (true/false)|telemetry:vehicle:engines|
            |vehicle.engines.thermic.oil.temp |Integer (signed)|equalsTo/greaterThan/ lowerThan/ |Value|telemetry:vehicle:engines|
            |vehicle.energy.electric.level |Number (unsigned)|equalsTo/greaterThan/ lowerThan/ |Value|telemetry:vehicle:energies|
            |vehicle.energy.electric.autonomy |Number (unsigned)|equalsTo/greaterThan/ lowerThan/ |Value|telemetry:vehicle:energies|
            |vehicle.energy.fuel.level |Number (unsigned)|equalsTo/greaterThan/ lowerThan/ |Value|telemetry:vehicle:energies|
            |vehicle.energy.fuel.autonomy |Number (unsigned) |equalsTo/greaterThan/ lowerThan/ |Value|telemetry:vehicle:energies|
            |vehicle.autonomy (global) |Number (unsigned)|equalsTo/greaterThan/ lowerThan/ |Value|telemetry:vehicle:energies|
            |vehicle.energy.charging.status |Enum(ChargingStatusEnum) |onChange/equalsTo |Value|telemetry:vehicle:energies|
            |vehicle.energy.charging.plugged |Boolean |onChange/equalsTo |Value|telemetry:vehicle:energies|
            |vehicle.doorsState.lockedState |N/A |onChange |Value|telemetry:vehicle:doorsState|
            |vehicle.doorsState.opening |N/A |onChange |Value|telemetry:vehicle:doorsState|
            |vehicle.kinetic.moving| Boolean |onChange/equalsTo |Value (true/false)|telemetry:vehicle:kinetic|
            |vehicle.kinetic.speed |Number (unsigned) |equalsTo/greaterThan/ lowerThan/ |Value |telemetry:vehicle:kinetic|
            |vehicle.trip.start| Literal |onChange| Value(IDTRIP) |trip|
            |vehicle.trip.stop| Literal |onChange| Value(IDTRIP) |trip|
            |vehicle.maintenance.daysBeforeMaintenance, |Number (signed)|equalsTo/ greaterThan/ lowerThan/ |Value |telemetry:vehicle:maintenance|
            |vehicle.maintenance.mileageBeforeMaintenance| Number (signed)|equalsTo/ greaterThan/ lowerThan/ |Value |telemetry:vehicle:maintenance|
            |vehicle.safety.beltWarning |Enum(beltWarning) |onChange/equalsTo |Value |telemetry:vehicle:safety|
            |vehicle.safety.autoECallTriggering |Enum(safety.autoECallTriggering) |equalsTo / onChange/includedIn |Value |telemetry:vehicle:safety|
            |environment.air.temp |Number (signed)|equalsTo/greaterThan/lowerThan/ |Value |telemetry:environment|
            |privacy.state |Enum(Privacy) |equalsTo / onChange/includedIn |Value |telemetry:privacy|
            |vehicle.drivingBehavior.mode |Enum(drivingBehavior.mode) |equalsTo / onChange/includedIn |Value |telemetry:vehicle:drivingBehavior|
            |vehicle.collision.side |Enum(collision.side) |equalsTo / includedIn |Value |collision|
            |vehicle.collision.severity |Enum(collision.severity) |equalsTo / includedIn |Value |collision|
            |vehicle.preconditioning.airConditioning |N/A| onChange |Value |telemetry:vehicle:preconditioning|
            | vehicle.alarm.trigger.type | Enum(trigger.type)| onChange/equalsTo/includedIn  | Value |
            | vehicle.alarm.status.activation | Enum(status.activation)| onChange/equalsTo  | Value |

                        
            The right operand  (value) argument depends on the type of operation (OP) as following:
              
              * onChange: no value because we are monitoring the change between two states (before and after).
              * includedIn: value must be an array of size> = 1
              * equalsTo, greaterThan and lowerThan: the value must be an array of size = 1.
              
            _Note:_ *Number (float)* and *integer* types can be signed or not. This format must be respected in the data trigger and an inconsistency (negative value for an unsigned or float for an integer) generates a bad-query error.
#              
          type: string
          enum:
            - vehicle.alert
            - vehicle.alarm.trigger.type
            - vehicle.alarm.status.activation
            - vehicle.odometer
            - vehicle.engines.running
            - vehicle.engines.thermic.oil.temp
            - vehicle.energy.electric.level
            - vehicle.energy.electric.autonomy
            - vehicle.energy.fuel.level
            - vehicle.energy.fuel.autonomy
            - vehicle.autonomy
            - vehicle.energy.charging.status
            - vehicle.energy.charging.plugged
            - vehicle.doorsState.lockedState
            - vehicle.doorsState.opening
            - vehicle.kinetic.moving
            - vehicle.kinetic.speed
            - vehicle.maintenance.daysBeforeMaintenance
            - vehicle.maintenance.mileageBeforeMaintenance
            - vehicle.safety.beltWarning
            - vehicle.safety.autoECallTriggering
            - environment.air.temp
            - privacy.state
            - vehicle.drivingBehavior.mode
            - vehicle.collision.side
            - vehicle.collision.severity
            - vehicle.preconditioning.airConditioning
            - vehicle.trip.start
            - vehicle.trip.end
        op:
            description: The operator of the trigger function.                          
            type: string
            enum: [equalsTo, greaterThan, lowerThan, includedIn, onChange]
        value:
            description: |
              The right operand of the trigger function. It can be a uniq ```value``` or a list of value ```values```. The choice of one or the other depends on ```OP```  which in the case of ```includedIn``` must be a list.
                * _Disclaimer_: If the op field is not set to ```includeIn``` then only the first item will be used.
#                
            type: array
            items:
              type: string
        previous: 
          description: |
            The previous trigger state represents the initial state of the monitored data that allow its trigger to fire.  Only data that is in the following list is allowed. A 'previous data state' defined here must match the defined in the trigger data.
                        
            |**Previous Data**|**Type**|**Eligible Op**|**Previous Value**|**oAuth2 scope**|
            |---|---| ---:| ---:|---:|
            |vehicle.alert|List of value|includedIn/equalsTo| Value (AlertEnum)|alert|
            |vehicle.engines.running|Boolean|equalsTo| Value (true/false)|telemetry:vehicle:engines|
            |vehicle.energy.charging.status|Enum(ChargingStatusEnum)|includedIn/equalsTo| Value(ChargingStatusEnum)|telemetry:vehicle:energies|
            |vehicle.energy.charging.plugged|Boolean|equalsTo| Value (true/false)|telemetry:vehicle:energies|
            |vehicle.kinetic.moving|Boolean|equalsTo| Value (true/false)|telemetry:vehicle:kinetic|
            |vehicle.safety.beltWarning|Enum(beltWarning)|includedIn/equalsTo| Value(Enum(beltWarning))|telemetry:vehicle:safety|
            |vehicle.safety.autoECallTriggering| Enum(safety.autoECallTriggering)|equalsTo/includedIn| Value(enum)  |telemetry:vehicle:safety| 
            |privacy.state|Enum(Privacy)|equalsTo/includedIn| Value(Enum(Privacy))|telemetry:privacy|
            |vehicle.drivingBehavior.mode|Enum(drivingBehavior.mode)|equalsTo/includedIn| Value(Enum(drivingBehavior.mode))|telemetry:vehicle:drivingBehavior|                           

            _Note:_  
              * This state will only be interpreted on the first triggering of the trigger. For the triggering due to "refresh" mode, this previous state will not be taken into account.
              * If the trigger predicate backs to 'false' then the previous state becomes again an initial necessary condition  to trigger the monitored data.
              
            The  value  depends on the type of Eligible OP  as following:
              
              * includedIn: value must be an array of size> = 1
              * equalsTo: the value must be an array of size = 1.
          type: object
          properties: 
            data: 
              type: string
              enum:
                - vehicle.alert
                - vehicle.engines.running
                - vehicle.energy.charging.status
                - vehicle.energy.charging.plugged
                - vehicle.kinetic.moving
                - vehicle.safety.beltWarning
                - vehicle.safety.autoECallTriggering
                - privacy.state
                - vehicle.drivingBehavior.mode
            value:
                description: |
                  The trigger previous state data literal value.
                type: array
                items:
                  type: string
          required: [data,value]
            
      required: [data,op]
      example:
        data: vehicle.energy.electric.level
        op: greaterThan
        value: ["75"]
    Monitors:
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                monitors:
                  type: array
                  items:
                    $ref: '#/components/schemas/Monitor'
    
    RemoteType:
          type: string
          enum: 
            - ThermalPreconditioning
            - ElectricBatteryChargingRequest
            - Horn
            - Doors
            - Lights
            - Immobilization
            - Stolen
            - WakeUp
            - Navigation
  
    ChannelType:
          type: string
          enum: 
            - Remote
            - Monitor
    
    SubscribeType:
          type: array
          items:
            type: string
            enum: 
              - Monitor
              - Remote
              - Datastream
    RemoteTypes:
          type: array
          items:
            $ref: '#/components/schemas/RemoteType'
    ChannelTypes:
          type: array
          items:
            $ref: '#/components/schemas/ChannelType'        
        

    RemoteCharging:
                  type: object
                  description: Remote electric battery charging action.
                  properties:
                    nextDelayedTime:
                      description:  Timestamp (as defined in [RFC3339](https://www.ietf.org/rfc/rfc3339.txt)) of the next battery charging time.
                      type: string
                    immediate:
                      type: boolean
                      description :  Determines if the charging will start immediately(```true```) or not.
    
    RemoteSetStolen:
                  type: object
                  description: Remote to set the vehicle in stolen state.
                  properties:
                    stolen:
                      type: boolean
                      description :  Set, if ```true```, the vehicle as stolen or not (otherwise). 
                  required: [stolen]
    
    RemoteLights:
                  type: object
                  description: Remote to swith on / off lights.
                  properties:
                    on:
                      type: boolean
                      description :  Swith, if ```true```, the vehicle lights ON  or OFF (otherwise).   
                    #duration:
                      #description : |
                        #The duration of the lighting if switched on (expressed using  [ISO-8601 Duration spec](https://en.wikipedia.org/wiki/ISO_8601#Durations))
                          #* minimum: ```PT1S```  _1 sec_.
                          #* maximum: ```PT2M0S```   _120 sec_.
                      #type: string
                      #default: PT10S
                      #example: PT20S
                  required: [on]
    
    RemoteWakeUp:
                  type: object
                  description: Remote to wake up a vehicle (so it can update its data).
                  properties:
                    action:
                      type: string
                      default: Wakeup
                      example: Wakeup
                      items:
                        enum: [Wakeup]
    RemoteNavigation:
                  type: object
                  description: A remote to share GPS positions with the vehicle so it can navigate through those positions by driving from start (1st) to end (last) position.
                  properties:
                    driverApproval:
                        description: Whether sharing position with vehicle requires driver approval or not. 
                        type: boolean
                        default: false
                    positions:
                        type: array
                        items:
                            $ref: '#/components/schemas/Point'   
                  required:
                      - positions
                    
    RemotePreconditioning:
      type: object
      description: Remote preconditioning the vehicle.
      properties:
        airConditioning:
          description: At least one of the parameters must be provided.
          type : object
          properties:
            immediate:
              type: boolean
              default: false
              description :  Determines whether air conditioning will start immediately or not independently if scheduled ```programs``` are set or not. Set to "false" by default..
            programs:
              description : List of air conditioning programs to schedule on vehicle.
              type: array
              items:
                allOf:
                  - $ref: '#/components/schemas/Program'

                  - description: |
                        Air conditioning program to schedule on vehicle. ```Be aware about the action type (see below)```.
                        
                          * _Note_:The requirement to have fields provided or not depends on the value of the fields "actionsType".indeed, fields are provided when:
                          
                              |<b>actionsType</b>|<b> Mandatories</b> |
                              |:------------------: |:-------------------: |
                              |- Set |<p>slot, enabled, occurence, start</p> |
                              |- Delete |slot |
                           
                          ## *The field  ```actionsType```is not mandatory and will be set to ```'Set'``` value if not provided.*
#                          
                  - properties: 
                      slot:
                        type: integer
                        description: This program number. Can only be used ONE time in the same preconditioning list.
                        minimum: 1
                        maximum: 4
                      enabled:
                          type: boolean
                          description: Determines whether this program is enabled or not.
                  

                      actionsType:
                        description: |
                            Action type to apply for this program:
                            
                            * Delete: Delete this air conditioning program entry. Need only the slot number of the program to remove.  
                            * Set: Create a new programe o update it if existing. Need to provide all field correctly set.
#                            
                        type: string
                        enum: [Delete, Set]
                        default: Set
                  - required: [slot] 
          
    RemoteDoorsState:
      type: object
      description: Remote vehicle door (lock/unlock) state.
      properties:
        state:
              type: string
              enum: [Unlocked, Locked]
              
      required: [state]
          
    RemoteHorn:
      type: object
      description: Remote vehicle horn activation.
      properties:
      #      number:
      #        type: integer
      #        description : Number of vehicle horn activations.
      #        default: 1
      #        minimum: 1
      #        maximum: 5
            state:
              type: string
              description : Activate or unactivate this remote horn.
              enum: [Activated,Unactivated]
      required: [state]
      
    RemoteSetImmobilization:
      type: object
      description: Requesting the vehicle for immobilization.
      properties:
            activate:
                type: boolean
                description :  Set, if ```true```, the vehicle as immobilized or not (otherwise). 
      required: [activate]
    
    Remote:
      type: object
      description: Remote vehicle action object that defines the label, additional attributes and the action of the sent remote. 
      properties:
        label:
          type: string
        attributes:
              $ref: '#/components/schemas/RemoteAttributeSet'
        channelAttributes:
          allOf:
              - description: |
                            Additional attributes that will be add to or replace the specific channel (pushnotif, webhook or websocket) ones when sending the remote event.
                            
                            * Note: Union attributes set. Only one of the following: pushnotif, webhook orwebsocket should be set and it should be consistent with the channel type to wich this remote is associated              
              - $ref: '#/components/schemas/ChannelAttributes'
        action:
          description: Union Remote vehicle actions type. The provided can be ```only one``` of the following actions
          properties:
            preconditioning:
              $ref: '#/components/schemas/RemotePreconditioning'
            immobilization:
              $ref: '#/components/schemas/RemoteSetImmobilization'
            door:
              $ref: '#/components/schemas/RemoteDoorsState'
            horn:
              $ref: '#/components/schemas/RemoteHorn'
            charging:
              $ref: '#/components/schemas/RemoteCharging'
            stolen: 
              $ref: '#/components/schemas/RemoteSetStolen'
            lights: 
              $ref: '#/components/schemas/RemoteLights'
            wakeup: 
              $ref: '#/components/schemas/RemoteWakeUp'
            navigation:   
              $ref: '#/components/schemas/RemoteNavigation'
        onEvent:
          $ref: '#/components/schemas/OnRemoteEvent'
        
    ChannelRef: 
      type: object
      description: channel reference returned when posting/getting a channel.
      properties:
            _links:
                type: object
                properties:
                  channel:
                    $ref: '#/components/schemas/Link'
            channelId:
              $ref: '#/components/schemas/ChannelId'
            status:
              $ref: '#/components/schemas/RunStatus'          
    
      
    RemoteActionStatus:
      type: string
      enum: [Accepted, Pending, Failed, Success]
   
    RemoteRef: 
      type: object
      properties:
           
            remoteActionId:
              $ref: '#/components/schemas/RemoteActionId'
            status:
              $ref: '#/components/schemas/RemoteActionStatus'
            type:
                  $ref: '#/components/schemas/RemoteType'
    
    RemotePostResponse: 
      type: object
      description: Remote action reference returned when posting a remote action.
      properties:
            _links:
                type: object
                properties:
                  channel:
                    $ref: '#/components/schemas/Link'
                  remote:
                    $ref: '#/components/schemas/Link'
            remoteActionId:
              $ref: '#/components/schemas/RemoteActionId'
            type:
               $ref: '#/components/schemas/RemoteType'           
    
    RemoteAction: 
      allOf:
        - $ref: '#/components/schemas/RemoteRef'
        - description: Remote action with its current state.
          properties:
                _links:
                  type: object
                  properties:
                    channel:
                      $ref: '#/components/schemas/Link'
                    self:
                      $ref: '#/components/schemas/Link'
                remoteActionId:
                  $ref: '#/components/schemas/RemoteActionId'
                remote:
                  $ref: '#/components/schemas/Remote'
                status:
                  $ref: '#/components/schemas/RemoteActionStatus'
    
    RemoteActions:
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                remoteActions:
                  type: array
                  items:
                    $ref: '#/components/schemas/RemoteAction'
    
    RemoteActionId:
      type: string
      description: The uniq remote action  ID returned when the remote action was posted and accepted.
##Group    
    GroupId:
      type: string
      pattern: '([0-9a-fA-F]|-|_)*'
      description: Uniq group ID.
      
    GroupObj: 
      description: A vehicles group.
      type: object
      properties:
        name:
          type: string
          pattern: '\b(?!root\w*\b)\w+'
          description: The group name should not be prefixed by word "*root*" since its the master group name.
        description: 
          type: string
          description: Additional group description.
      required: [name]

    Group:
     allOf:
      - $ref: '#/components/schemas/GroupObj'
      -   properties:
            _links:
              type: object
              properties:
                self:
                  $ref: '#/components/schemas/Link'
                vehicles:
                  $ref: '#/components/schemas/Link'
               
            id:
              $ref: '#/components/schemas/GroupId'
          required: [id,_links]
      
    Groups:
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                groups:
                  type: array
                  items:
                    $ref: '#/components/schemas/Group'
    ChannelId:
      type: string
      pattern: '([0-9a-fA-F]|-|_)*'
      description: Uniq channel ID returned when the channel was subscribed (created) succefuly.
    Channel:
      description:  channel state.
      type: object
      properties:
        _links:
          type: object
          properties:
            self:
              $ref: '#/components/schemas/Link'
           
        label:
          type: string
        id:
          $ref: '#/components/schemas/ChannelId'
        subscribe:
          $ref: '#/components/schemas/ChannelSubscribe'
        status:
          $ref: '#/components/schemas/RunStatus'
      required: [status,id,subscribe]
    
    Channels:
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                channels:
                  type: array
                  items:
                    $ref: '#/components/schemas/Channel'
    
    ChannelStatusSetter:
      allOf:
        - $ref: '#/components/schemas/RunStatusSetter'
        - title: ChannelStatusSetter
          description: Channel Status setter used to change the state from running to paused and vice versa. 
     
            
    BaseAlarmTrigger:
      type: object
      title: Vehicle Alarm Trigger
      description: Describe a vehicle alarm trigger.
      properties:
          type: 
            description: Define the vehicle break-in type.
            type: string
            enum:
                - NoBreakIn
                - FrontRightDoorBreakIn
                - FrontLeftDoorBreakIn
                - RearRightFrontDoorBreakIn
                - RearLeftFrontDoorBreakIn
                - HoodDoorBreakIn
                - TrunkDoorBreakIn
                - BackliteDoorBreakIn
                - RoofBreakIn
                - VolumetricBreakIn
                - VehicleLifting
                - ElectricalsystemBreakIn
                - KeyLearning
                - UnauthenticatedStartup
          position:
            allOf:
                - description: The position (last vehicle known one) where the alarm triggered.
                - $ref: '#/components/schemas/Position'
          startAt:
            description: Time when the alarm triggering started.
            type: string
            format: date-time
          endAt:
            description: Time when the alarm triggering ended.
            type: string
            format: date-time
      required: [type, startAt]
      
      
    BaseAlarmStatus:
      type: object
      title: Vehicle Alarm Status
      description: Describe a vehicle alarm status.
      properties:
          activation: 
            description: Define whether the vehicle alarm is active or not.
            type: string
            enum: [Inactive, Active]
      required: [activation]
        
    BaseAlarm:
      type: object
      title: VehicleAlarm
      description: Describe a vehicle alarm status and trigger.
      properties:
        id : 
          type : string
        status:
          $ref: '#/components/schemas/BaseAlarmStatus'
        trigger:
          $ref: '#/components/schemas/BaseAlarmTrigger'
      
    AlarmTrigger:
      allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - $ref: '#/components/schemas/BaseAlarmTrigger'
        - title: Vehicle Alarm Trigger
        - required: [type, startAt, createdAt]
    AlarmStatus:
      allOf:
        - $ref: '#/components/schemas/CreatedAtField'
        - $ref: '#/components/schemas/BaseAlarmStatus'
        - title: Vehicle Alarm Status
        - required: [activation, createdAt]
    Alarm:
      type: object
      title: Vehicle Alarm
      description: Describes the vehicle alarm status or trigger. Only one is present.
      properties:
        id:
          type : string
        trigger:
            $ref: '#/components/schemas/AlarmTrigger'
        status:
            $ref: '#/components/schemas/AlarmStatus'
    VehicleStatusAlarm:
      allOf:
        - $ref: '#/components/schemas/Alarm'
        - description: Describes the current vehicle alarm status and the latest (if available) trigger.
         

    Alarms:
      title: Alarm array
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                alarms:
                  type: array
                  items:
                    $ref: '#/components/schemas/Alarm'
    OnEvent:
      type: object
      description: Allow  to define the behavior to have  when a Monitor Triggering or Remote command return event occurs.
      properties:
        actions:
          type: array
          items: 
            type: object
            description: Possible action types. 
            properties:
              type: 
                type: string
                description: |
                  The selected type should be consistent with the action defined in the object:
                    | type   | required field| 
                    |----------|:-------------:|
                    | Notify |<i> no field</i>| 
                    | Remote |remoteAction|   
                    | Monitor|monitorAction |  
                  otherwise, a *'bad query paramter (HTTP 400)'* is returned.
                  * Note: All necessary authorization scopes for the defined actions should be granted when creating the 'on-event' entry within Monitor and Remote object.
                enum: [Notify, Remote, Monitor]
              monitorAction:
                type: object
                description:  Allow to change a monitor lifecycle. The Id of monitor can be provided and if keep empty that means the  current(object parent) monitor will be used. However, if this 'OnXEvent' object is not created within a Monitor (ie remote) and the monitor-ID is not provided then a bad query parameter (HTTP 400) error will be returned.
                properties:
                  changeType:
                    type: string
                    enum: [Pause, Resume, Delete]
                  monitorId:
                    $ref: '#/components/schemas/MonitorId'
                required: [changeType]
              remoteAction:
                type: object
                description: Allow to perform a remote on the vehicle which caused the event. A channel id can be provided as remote status notification channel. If this channel ID is not provided then the remote will be perfomrmed silently. 
                properties:
                  ChannelId:
                      $ref: '#/components/schemas/ChannelId'
                  remote:
                      $ref: '#/components/schemas/Remote'
                required: [remote]
                      
 ####
    RemoteEventType:
      description: | 
        The event type. See```status```for event sate.
        * Pending event is related to intermediate state of the action before it is handled by the vehicle.
        * Done event is related to a final state of the action when handled by the vehicle.
         
      type: string    
      enum: 
            - Pending
            - Done
            
    RemoteDoneEventStatus:
      description: | 
        The reponse event status. 
         
      type: string    
      enum: 
            - Success
            - AlreadyDone
            - Failed
            
    RemotePendingEventStatus:
      description: | 
        The processing event status. 
         
      type: string    
      enum: 
            - Accepted
            - WakingUpVehicle
            - CheckingVehicle
            - SentToVehicle
            - VehicleBatteryChargeTooLow
            - TooManyWakeUpsOverMonth
            
    RemoteFailedEventStatus:
      description: | 
        The failure cause for event with failed status. This field is filled only is failure state. 
         
      type: string    
      enum: 
            - GeneralError
            - VehicleError
            - WrongCommand
            - VehicleConnectionTimeout
            - MissingRights
            - NotPossibleDueToVehicleBatteryLevel
            - NotPossibleDueToVehiclePrivacyLevel
            - TooManyWakeUpsOverMonth
            - TooManyRequestInShortTime
            - SameActionInProgress
            - NotPossibleDueToVehicleStolenState
            - VehicleInUse
            - TooManyRequestSent 
            - DoorsOpen
            - VehicleErrorOrCidInside
            - CidInside
            - ExternalChargingSystemError
            - VehicleChargingSystemError
            - VehicleIsNotLocked
            - CanceledByDriver

             
    RemoteEventStatus:
              type: object
              properties:
                type:   
                  $ref: '#/components/schemas/RemoteEventType'
                status:
                  oneOf:
                    - $ref: '#/components/schemas/RemoteDoneEventStatus'
                    - $ref: '#/components/schemas/RemotePendingEventStatus'
                failureCause:   
                  $ref: '#/components/schemas/RemoteFailedEventStatus'

              required: [type,status]
              
    OnRemoteEvent:
      allOf:
        - $ref: '#/components/schemas/OnEvent'
        - description: Define the actions to do when this vehicle remote command is performed. _'onStatus' field express the condition to apply actions. If not set then the actions are applyed for all remote status_. 
          properties:
            onStatus:
              description: Condition (s) to the remote event should satisfy (*AND* logical relationship) to invoke this on-remote-event actions.
              type: array
              items:
                 $ref: '#/components/schemas/RemoteEventStatus'



    OnMonitorEvent:
      allOf:
        - $ref: '#/components/schemas/OnEvent'
        - description: Define the action(s) to do when this vehicle monitor trigger occures. _'onRefresh' field express the event nature, refresh too or normal only, for which the actions(s) will be performed_. 
          properties:
            onRefresh:
              description: Determines whether if this on-monitor-event's actions will be performed for monitor refresh avent too.
              type: boolean
              default: false


    ######    data stream
    DataStreamAttribute:
      allOf:
        - $ref: '#/components/schemas/BasicAttribute'
        - properties:
              value:
                oneOf:
                  - type: string
                  - type: string
                    enum: [vin,datastreamType,fleetID] 
                    description: |
                      Set of variables that will be contextually valued and used as attribute value. To reference the variable, prefix its name with the dollar sign ($)  
                      
                      * Disclaimer: if the var "vin" is used as a query parameter, the batchnotify will be no more possible and each event will be sent through a separated request!.
                      * example: Having a vin=VIN123456, the following attribute set:
                              ```"attributes": [
                                  {
                                    "type": "Header",
                                    "key": "X-vehicle-id"
                                    "value":"$vin"
                                  }
                                ]```
                        will be valued as http header extension: 
                                
                        *"X-vehicle-id: VIN123456"*          
        

    DataStreamAttributeSet:          
        type: array
        description: |
            Additional attributes-set as key/value pairs wich will be added to the request when sending the event. It can be added as *header* entries or simply added to the notification event *body* (as set of key/values).
        items:
            $ref: '#/components/schemas/DataStreamAttribute'  
        example:
            - type: Header
              key: X-Vehicle_Id
              value: $vin
            - type: Query
              key: RemoteType
              value: $remoteType      
    DataStream:
      type: object
      required:
        - callbackId
        - data
      properties:
        callbackId:
              $ref: '#/components/schemas/ChannelId'
        attributes:
          $ref: '#/components/schemas/DataStreamAttributeSet'        
        data:
          type: object
          properties:
            telemetry:
              description:
                Datastream Telemetry data type. A subset of telemetries can be selected by provinding type field. If not type is set then the whole telemetries are selected.
              type: object
              properties:
                type:
                  $ref: '#/components/schemas/TelemetryEnum'
                cycle:
                  description: Cycle time between two event sends expressed in seconds. This period is subject to the periodicity of its source data at vehicle level. 
                  type: integer
                  minimum: 1
                
    DataStreams:
      allOf:
        - $ref: '#/components/schemas/CollectionResult'
        - properties:
            _embedded:
              type: object
              properties:
                dataStreams:
                  type: array
                  items:
                    $ref: '#/components/schemas/DataStream'                
                  
                              
    DataStreamPostResponse: 
      type: object
      description: DataStream reference returned when posting a remote action.
      properties:
            _links:
                type: object
                properties:
                  channel:
                    $ref: '#/components/schemas/Link'
                  dataStream:
                    $ref: '#/components/schemas/Link'
            datastreamId:
              $ref: '#/components/schemas/RemoteActionId'
            status:
              $ref: '#/components/schemas/RunStatus'
              
    DataStreamStatusSetter:
      allOf:
        - $ref: '#/components/schemas/RunStatusSetter'
        - title: DataStreamStatusSetter
          description: DataStream Status setter used to change the state from running to paused and vice versa. 
          
              
    GroupMaintain:
          title: GroupMaintain
          description: | 
            The 'Add' and 'Remove' actions require a Vin list while the 'Copy' action requires the 'groups' parameter. The parameters must therefore be submitted with  consistency (see below) otherwise, an error (400) will be raised. 
            
            | Action  | Mandatory field  |  
            |---|---|
            | Add  | vins (non empty)  | 
            | Remove   | vins (non empty)  | 
            | Copy  | groups (non empty)  |            
          properties:
            action:
              type: string
              enum: [Add, Remove, Copy]
            vins:
              type: array
              description: List of (owned) vehicle identifiers.
              items:
                type: string
            groups:
              type: array
              description: List of (owned) )group IDs to copy from.
              items:
                type: string
                pattern: '([0-9a-fA-F]|-|_)*'

    ######
####################
        
  parameters:

    genericId:
      name: ''
      required: true
      in: path
      schema:
        type: string
        #    apiClientId:
        #      name: client_id
        #      description: The client ID related to the API  account.
        #      in: query
        #      required: true
        #      schema:
        #        type: string
        #        pattern: '([0-9a-fA-F]|-|_)*'
    alertId:
      name: aid
      in: path
      description: id of the alert.
      required: true
      schema:
        type: string
    alarmId:
      name: aid
      in: path
      description: id of the alamr.
      required: true
      schema:
        type: string
    activeAlert:
      name: active
      in: query
      description: Active alert query parameter. Boolean flag filter. Active alert = true; done alert = false; not present then no filter is applyed.
      schema:
        type: boolean
    collisionId:
      name: cid
      in: path
      description: Results will only contain the Collision related to this Collision *id*.
      required: true
      schema:
        type: string
    vehicleId:
      name: id
      in: path
      description: Results will only be related to this Vehicle *id*.
      required: true
      schema:
        type: string
    tripId:
      name: tid
      in: path
      required: true
      description: the *id* of Trip
      schema:
        type: string
    locale:
      name: locale
      in: query
      description: Locale is used for rendering text, correctly displaying regional monetary values, time and date formats. Respect REGEX \w(-\w)?
      required: false
      schema:
        type: string
    timestamps:
      name: timestamps
      in: query
      description: |
          Array of  **"timestamp"** ranges. Results will contain results whose
          timestamps are included in those date-time ranges (see **timestamp**
          data  model).**"timestamp"** items should be expressed as in
          '[RFC3339](https://www.ietf.org/rfc/rfc3339.txt)'. Each element of the array expresses a time range (with the pattern ```\w?/\w?``` or ```R\d?/w/w(/w)?```) which is the period between two or more times. The range can be expressed by two times Points (start and end *Timestamp*s), by a start
                *Timestamp* Point and a *Duration* or as a repeating interval. All of
                them  should be expressed using the 
                [RFC3339](https://www.ietf.org/rfc/rfc3339.txt) and the interval format
                is based on
                [ISO8601](https://en.wikipedia.org/wiki/ISO_8601#Time_intervals)
        
                    'T1/T2' interval time from low limit T1 to hight T2
          
                    'T1/D' interval time from low limit T1 with duration = D ( T2=T1+D)
          
          
                    'T/' endless range, known start Timestamp but no end Timestamp. The current time  will be used as the high time limit.
          
          
                    '/T' startless range, known end date but no start date. No lower limit
                      will be used to retrieve results.
                      
                    Rn/T/D/[d]  repeat the interval of D **n** times starting at T using **d** (extension of the standard and not mandatory) as range duration. The default (duration) value of d is 24 H 
                    
                    R/T/D/[d] unbounded number of repetitions starting at T using **d** (extension of the standard and not mandatory) as range duration. The default (duration) value of d is 24 H.
          
          
                      *T is a timestamp and D is a duration  as defined in [RFC3339](https://www.ietf.org/rfc/rfc3339.txt).*
          *Example:*          
                      
                    2018-01-01T09:00:00+01:00/2018-01-01T12:00:00+01:00* known low and hight limits.
          
                    2018-01-03T12:00:00+01:00/P3Y6M4DT12H30M5S*  known low limit, hight limit = start + duration.
          
                    2018-01-03T12:00:00+01:00/*  known low limit, hight limit = current time.
                      
                    R5/2018-01-03T12:00:00Z/P6H/P2H* repeate duration 6H wiht interval period of 2H for 5 times starting at 2018-01-03T12:00:00Z.
#              
      required: false
      schema:
        type: array
        minItems: 1
        maxItems: 10
        items:
          type: string
          pattern: \w?/\w?
         # $ref: '#/components/schemas/TimeRange'
    
    pageSize:
      name: pageSize
      in: query
      schema:
        type: integer
        default: 100
        minimum: 1
      required: false
      description: The maximum number of results (for a collection results response) to
        return per page. When not set, at most 100 results will be returned.
         
    pageToken:
      name: pageToken
      in: query
      schema:
        type: string
      required: false
      description:  Start-Page marker, the token for continuing a previous list request on
        the next page. It is built and used by the backen **only**.
    indexRange:
      name: indexRange
      in: query
      schema:
      
       # $ref: '#/components/schemas/indexRange'

                type: string
                pattern: \d+-\d*
                default: 0-
                  
          
          ##        
      required: false
      description: >
        Results indexes will be included in this range. this range is used to express the first (offset) and the last results
                  index  to retrieve. With the respect to the regex pattern ```\d+(-\d*)?```,
                  the start of  range is mandatory ( 0 for default).
          
          
        *Example:*
          
          
                  *  '0-9'  : start=0, end=9    ==> offset=0 and number of items=10
          
          
                  * '5-'    : start =5, no end  ==> start at 5th to the end results.
          
          default: 0-

          example: 0-, 0-5
#           
    telemetryType:
      name: type
      in: query
      description:  Results will only contain Telemetry data of the elected type(s). More than one message type can be added. 
                    By default, if no type is selected then all telemetries will be selected ```(the number of elements in this array must be bounded between 1 and 10)```.
      required: false
      schema:
        $ref: '#/components/schemas/TelemetryEnum'
    alarmType:
      name: type
      in: query
      description:  Results will only contain Alarm messages of this type.  If no filtering type is selected then all alarms will be taken .
      required: false
      schema:
        $ref: '#/components/schemas/AlarmTypeEnum'
    extension:
      name: extension
      in: query
      description: >-
        Additional data set that will be included in embedded field 
        
         * _Disclaimer_:  **Enabling ```maintenance``` extension will automatically disable ```Kinetic``` telemetry message**
#          
      required: false
      schema:
        $ref: '#/components/schemas/TelemetryExtensionType'    
    
    tolerence:
      name: tolerance
      description: >
          Tolerance factor is expressed in length KM unit and is used to simplify path by reducing the total number of points by is using Douglas-Peucker algorithme to find a similar curve with fewer points (find more info here: [Ramer_Douglas_Peucker_algorithm](https://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm#Algorithm) ).
#           
      in: query
      schema:
        type: number
        format: float
    
    statusExtension: 
      name: extension
      in: query
      description: >-
        Additional data set that will be included in embedded field 
        
         * _Disclaimer_:  **Enabling ```odometer``` extension will automatically disable ```kinetic``` telemetry message**
#       
      required: false
      schema:
        $ref: '#/components/schemas/StatusExtensionType'

    monitorId:
      name: mid
      in: path
      description: id of the monitor.
      required: true
      schema:
        type: string
        
    remoteType:
      name: types
      in: query
      description: Results will contain only the Remote-channels of these types. _If not specified then the whole channels are retrieved_.
      required: false
      schema:
        $ref: '#/components/schemas/RemoteTypes'    

    channelType:
      name: types
      in: query
      description: Results will contain only the channels of these types. _If not specified then the whole channels are retrieved_.
      required: false
      schema:
        $ref: '#/components/schemas/ChannelTypes'
    groupIdQry:
      name: gId
      description: Enable filtering on vehicles belonging to this group.
      in: query
      required: false
      schema:
        type: string
        pattern: '([0-9a-fA-F]|-|_)*'
    vinPrefix:
      name: vinPrefix
      in: query
      description: Enable filtering on prefixed VINs only.
      schema:
        type: string  
    groupId:
      name: gId
      description: The Group ID.
      in: path
      required: true
      schema:
        type: string
        pattern: '([0-9a-fA-F]|-|_)*'
        
    channelId:
      name: chId
      description: The channel ID.
      in: path
      required: true
      schema:
        type: string
        pattern: '([0-9a-fA-F]|-|_)*'
        
    remoteId:
      name: rid
      description: The remote action ID.
      in: path
      required: true
      schema:
        type: string
        pattern: '([0-9a-fA-F]|-|_)*'
    datastreamId:
      name: did
      description: The data stream ID.
      in: path
      required: true
      schema:
        type: string
        pattern: '([0-9a-fA-F]|-|_)*'     
    remoteToken:
      name: X-Remote-Acess-Token
      description: Remote action token that could be an OTP or an additional access token for flows like _Client Credentials Flow,Authorization Code Flow_.
      in: header
      required: true
      schema:
        type: string
        pattern: '([0-9a-fA-F]|-|_)*'
    callbackIdFilter:
      name: cbid
      description: The related callback ID .
      in: query
      required: false
      schema:
        type: string
        pattern: '([0-9a-fA-F]|-|_)*'
  responses:
    CollisionsuccessResponse:
      description: Collision response
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Collision'
    CollisionsSuccessResponse:
      description: A list of Collision
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Collisions'
    CollisionFailedResponse:
      description: Collision request error
      $ref: '#/x-fragment/general_error_fragment'
    AlertsucessResponse:
      description: Alert response
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Alert'
    AlertsuccessResponses:
      description: A list of alert
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Alerts'
    AlertFailedResponse:
      description: Alert request error
      $ref: '#/x-fragment/general_error_fragment'


    TripsucessResponse:
      description: Trip response
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Trip'
    TripsSuccessResponses:
      description: A list of Trip
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Trips'
    TripFailedResponse:
      description: Trip request error
      $ref: '#/x-fragment/general_error_fragment'
    TelemetrySuccessResponse:
      description: Telemetry response
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Telemetries'
    TelemetryFailedResponse:
      description: Trip request error
      $ref: '#/x-fragment/general_error_fragment'

    MonitorsuccessStatusResponse:
      description: Monitor response
      content:
        application/hal+json:
          schema:
            type: object
            properties:
              _links:
                type: object
                properties:
                  self:
                    $ref: '#/components/schemas/Link'
                  monitor:
                    $ref: '#/components/schemas/Link'
                 
              status:
                $ref: '#/components/schemas/RunStatus'        
    
    MonitorsuccessPostResponse:
      description: Monitor created or updated successfully
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/MonitorRef'        
    
    MonitorsuccessResponses:
      description: A list of Monitors
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Monitors'
    MonitorsuccessResponse:
      description: Monitor response
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Monitor'            
    
    MonitorFailedResponse:
      description: Monitor request error
      $ref: '#/x-fragment/general_error_fragment'
        #######  R E M O T E
    channelsuccessStatusResponse:
      description: Monitor response
      content:
        application/hal+json:
          schema:
            type: object
            properties:
              _links:
                type: object
                properties:
                  self:
                    $ref: '#/components/schemas/Link'
                  monitor:
                    $ref: '#/components/schemas/Link'
                 
              status:
                $ref: '#/components/schemas/RunStatus'        
    
    channelSuccessPostResponse:
      description: channel creation or update success response
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/ChannelRef'
            
    RemoteActionsSuccessPostResponse:
      description: Remote action creation success response (accepted).
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/RemotePostResponse'
        
    channelSuccessResponse:
      description: A channel.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Channel'
    
    ChannelSuccessResponses:
      description: A list of subsribed channel.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Channels'
    GroupsSuccessResponse:
      description: A list of existing groups.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Groups' 
    GroupSuccessResponse:
      description: A group.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Group'            
    RemoteActionSuccessResponses:
      description: A list of remote actions.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/RemoteActions'
            
    RemoteActionSuccessResponse:
      description: A remote action response.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/RemoteAction'
    
    #RemoteActions            
    ChannelFailedResponse:
        description:  Subscribe request error
        $ref: '#/x-fragment/general_error_fragment'        
    DatastreamSuccessResponse:
      description: A remote action response.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/DataStream'  

     
            

    
            
    DatastreamsSuccessResponse:
      description: Datastream list response.
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/DataStreams'
    DatastreamFailedResponse:
        description: Datastream request error
        $ref: '#/x-fragment/general_error_fragment'    
    
    DataStreamSuccessPostResponse:
      description: Remote action creation success response (accepted).
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/DataStreamPostResponse'

    AlarmSucessResponse:
      description: Alarm response
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Alarm'
    AlarmSuccessResponses:
      description: A list of alert
      content:
        application/hal+json:
          schema:
            $ref: '#/components/schemas/Alarms'
            
    AlarmFailedResponse:
      description: Alarm request error
      $ref: '#/x-fragment/general_error_fragment'
# 2) Apply the API key globally to all operations
security:
  - api_keyAuth: []     # use the same name as under securitySchemes
  -  api_oauth: []
x-fragment:
  Vehicles_getter:
    get:
      tags:
        - Vehicles
      summary: List of vehicules
      description: Returns the Vehicles associated with the User.
      operationId: getVehiclesByDevice
      parameters:
        - $ref: '#/components/parameters/groupIdQry'
        - $ref: '#/components/parameters/vinPrefix'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/locale'
        - $ref: '#/components/parameters/pageToken'
        
      security:
        - api_oauth:
            - vehicle_read
      responses:
        '200':
          description: OK
          content:
            'application/hal+json ':
              schema:
                $ref: '#/components/schemas/Vehicles'
        default:
          description: Vehicle not found
          $ref: '#/x-fragment/general_error_fragment'
  Vehicle_id_getter:
    get:
      tags:
        - Vehicles
      summary: Details of vehicule
      description: Returns detailed information about a Vehicle.
      operationId: getVehicleByid
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/locale'
      security:
        - api_oauth:
            - vehicle
      responses:
        '200':
          description: OK
          content:
            'application/hal+json ':
              schema:
                $ref: '#/components/schemas/Vehicle'
        default:
          description: Vehicle not found
          $ref: '#/x-fragment/general_error_fragment'
          
          
  #/vehicles/{id}/telemetries:
  Vehicle_id_telemetries_getter:  
    get:
     
      summary: Vehicle telemetries.
      tags:
        - Vehicles
      description: Returns the Telemetry data raised by the vehicle during a selective
        timestamp-ranges and bounded by an index range.
      operationId: getTelemetry
      parameters:
        
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/telemetryType'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/pageToken'
     #   - $ref: '#/components/parameters/extension'
      security:
        - api_oauth:
          - vehicle                
          - telemetry              
          - telemetry:environment        
          - telemetry:privacy          
          - telemetry:vehicle          
          - telemetry:vehicle:ignition      
          - telemetry:vehicle:preconditioning  
          - telemetry:vehicle:energies      
          - telemetry:vehicle:engines      
          - telemetry:vehicle:doorsState    
          - telemetry:vehicle:battery      
          - telemetry:vehicle:safety      
          - telemetry:vehicle:odometer      
          - telemetry:vehicle:kinetic      
          - telemetry:vehicle:propulsion    
          - telemetry:vehicle:brakingSystem    
          - telemetry:vehicle:transmission    
          - telemetry:vehicle:adas        
          - telemetry:vehicle:lighting      
          - telemetry:vehicle:maintenance
          - location
      responses:
        '200':
          $ref: '#/components/responses/TelemetrySuccessResponse'
        default:
          $ref: '#/components/responses/TelemetryFailedResponse'
          
#/vehicles/{id}/lastTelemetries:
  Vehicle_id_lasttelemetries_getter:
    get:
      tags:
        - Vehicles
      description: Returns an aggregation of the latest telemetries data raised by the vehicle as a tree of timestamped telemtry blocks.
      summary: Vehicle latest telemetry.
      operationId: getVehicleLastTelemetries
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/telemetryType'
      security:
        - api_oauth:
          - vehicle                
          - telemetry              
          - telemetry:environment        
          - telemetry:privacy          
          - telemetry:vehicle          
          - telemetry:vehicle:ignition      
          - telemetry:vehicle:preconditioning  
          - telemetry:vehicle:energies      
          - telemetry:vehicle:engines      
          - telemetry:vehicle:doorsState    
          - telemetry:vehicle:battery      
          - telemetry:vehicle:safety      
          - telemetry:vehicle:odometer      
          - telemetry:vehicle:kinetic      
          - telemetry:vehicle:propulsion    
          - telemetry:vehicle:brakingSystem    
          - telemetry:vehicle:transmission    
          - telemetry:vehicle:adas        
          - telemetry:vehicle:lighting      
          - telemetry:vehicle:maintenance
          - location
      responses:
        '200':
          description: Status response
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/AggregatedTelemetries'
        default:
          $ref: '#/x-fragment/general_error_fragment'          
          
          
          
          
          
          
 #'/vehicles/{id}/collisions':
  Vehicle_id_collisions_getter:
    get:
      summary: Collistions occured on the vehicle.
      tags:
        - Vehicles
      description: Returns the list of Collisions that occurred for a given vehicle (id) during the timestamp ranges and bounded by an index range
      operationId: getVehicleCollision
      parameters:
        
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/timestamps'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/pageToken'
        
      security:
        - api_oauth:
            - collision
            - vehicle
      responses:
        '200':
          $ref: '#/components/responses/CollisionsSuccessResponse'
        default:
          $ref: '#/components/responses/CollisionFailedResponse'
 # '/vehicles/{id}/collisions/{cid}':
  Vehicle_id_collisions_by_id_getter:  
    get:
      summary: A collistion occured on the vehicle.
      tags:
        - Vehicles
      description: Returns the Collision that matches the vehicle id and the Collision cid.
      operationId: getVehicleCollisionById
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/collisionId'
        
        
      security:
        - api_oauth:
            - collision
            - vehicle
      responses:
        '200':
          $ref: '#/components/responses/CollisionsuccessResponse'
        default:
          $ref: '#/components/responses/CollisionFailedResponse'

          
         
          
 # '/vehicles/{id}/alerts':
  Vehicle_id_alerts_getter:   
    get:
      tags:
        - Vehicles
      summary: Search for Alerts of vehicle.
      description: Returnsa filtred alert list for a Vehicle.
      operationId: getVehicleAlerts
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/activeAlert'
        - $ref: '#/components/parameters/timestamps'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/pageToken'
        
        

      security:
        - api_oauth:
            - alert
            - vehicle
            - location
      responses:
        '200':
          $ref: '#/components/responses/AlertsuccessResponses'
        default:
          $ref: '#/components/responses/AlertFailedResponse'
 # '/vehicles/{id}/alerts/{aid}':
  Vehicle_id_alert_by_id_getter:    
    get:
      summary:  'An alert (id) raised by the given vehicle'
      tags:
        - Vehicles
      description: Returns information about a specific alert messages for a Vehicle.
      operationId: getVehicleAlertsById
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/alertId'
      security:
        - api_oauth:
            - alert
            - vehicle
            - location
      responses:
        '200':
          $ref: '#/components/responses/AlertsucessResponse'
        default:
          $ref: '#/components/responses/AlertFailedResponse'          
  Vehicle_id_Trip_id_Telemetry_getter:
    get:
      summary: Telemetries of trip and vehicle
      tags:
        - Trips
      description: Returns the set of Telemetry values that occurred for a given vehicle
        (id) and a speific Trip (tid) during the timestamp ranges and bounded by
        an index range.
      operationId: getTelemetryForTrip
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/tripId'
        - $ref: '#/components/parameters/timestamps'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/telemetryType'
        - $ref: '#/components/parameters/extension'
      security:
        - api_oauth:
            - vehicle
            - trip
            - telemetry
            - location
      responses:
        '200':
          $ref: '#/components/responses/TelemetrySuccessResponse'
        default:
          $ref: '#/components/responses/TelemetryFailedResponse'
  Vehicle_id_Trip_id_wayPoints_getter:
    get:
      summary: Path of trip
      tags:
        - Trips
      description: Gives the Vehicle's wayPoints for a specified Trip.
      operationId: getPathForTrip
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/tripId'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/timestamps'
        - $ref: '#/components/parameters/tolerence'
        
        
      security:
        - api_oauth:
            - vehicle
            - trip
            - location
      responses:
        '200':
          description: Path response
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/WayPoints'
        default:
          description: wayPoints not found
  Vehicle_id_Trip_id_Collisions_id_getter:
    get:
      summary: A collsision happened for a given vehicle during a given trip
      tags:
        - Trips
      description: Returns a single Collision(cid) that occurred for a given vehicle(id) during
        a Trip(tid) .
      operationId: getVehicleCollisionByTipById
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/tripId'
        - $ref: '#/components/parameters/collisionId'
        
        
      security:
        - api_oauth:
            - vehicle
            - trip
            - collision
      responses:
        '200':
          $ref: '#/components/responses/CollisionsuccessResponse'
        default:
          $ref: '#/components/responses/CollisionFailedResponse'
  Vehicle_id_Trip_id_Collisions_getter:
    get:
      summary: Collsisions happened for a given vehicle during a given trip
      tags:
        - Trips
      description: Returns the set of Collisions that occurred for a given vehicle (id) and
        a speific Trip (tid) during the timestamp ranges and bounded by an index
        range.
      operationId: getVehicleCollisionsByTripId
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/tripId'
        - $ref: '#/components/parameters/timestamps'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/pageToken'
      security:
        - api_oauth:
            - vehicle
            - trip
            - collision
      responses:
        '200':
          $ref: '#/components/responses/CollisionsSuccessResponse'
        default:
          $ref: '#/components/responses/CollisionFailedResponse'
  Vehicle_id_Trip_id_Alerts_id_getter:
    get:
      summary: An alert for a given vehicle and trip 
      tags:
        - Trips
      description: Returns an  alert for a given Vehicle occured during a given trip
        and Trip.
      operationId: getVehicleTripAlertByAid
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/tripId'
        - $ref: '#/components/parameters/alertId'
        
      security:
        - api_oauth:
            - vehicle
            - trip
            - alert
            - location
      responses:
        '200':
          $ref: '#/components/responses/AlertsucessResponse'
        default:
          $ref: '#/components/responses/AlertFailedResponse'
  Vehicle_id_Trip_id_Alerts_getter:
    get:
      summary: Alerts for a given trip.
      tags:
        - Trips
      description: Returns the alert messages for a Vehicle occurend during a trip.
      operationId: getVehicleTripAlerts
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/tripId'
        - $ref: '#/components/parameters/activeAlert'
        - $ref: '#/components/parameters/timestamps'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/pageToken'
        
        
        - name: locale
          in: query
          description: Locale is used for rendering text, correctly displaying regional
            monetary values, time and date formats.
          required: false
          schema:
            type: string
      security:
        - api_oauth:
            - vehicle
            - trip
            - alert
            - location
      responses:
        '200':
          $ref: '#/components/responses/AlertsuccessResponses'
        default:
          $ref: '#/components/responses/AlertFailedResponse'


  Vehicle_id_Trip_id:
    get:
      summary: Get a vehicle trip
      tags:
        - Trips
      description: This method returns the Trip that matches the Trip id (tid) for a given
        Vehicle (id).
      operationId: getTripByVehicle
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/tripId'
        
        
      security:
        - api_oauth:
            - trip
            - vehicle
            - location
      responses:
        '200':
          $ref: '#/components/responses/TripsucessResponse'
        default:
          $ref: '#/components/responses/TripFailedResponse'


  Vehicle_id_Trips:
    get:
      summary: Get a vehicle trips
      tags:
        - Trips
      description: This method returns a list of all Trips that a given Vehicle has taken (including the pending one if available).
      operationId: getTripsByVehicle
      parameters:
        - $ref: '#/components/parameters/vehicleId'
        - $ref: '#/components/parameters/timestamps'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/pageToken'
        
        
      security:
        - api_oauth:
            - trip
            - vehicle
            - location
            - alert
            - telemetry:vehicle:odometer

      responses:
        '200':
          $ref: '#/components/responses/TripsSuccessResponses'
        default:
          $ref: '#/components/responses/TripFailedResponse'
  Vehicle_id_cb_id_monitors_get_post:
      ##GET PART
    get:
      tags:
        - Monitors
      summary: Get all monitors of the vehicle.
      description: Returns the list of subscribed Monitors.
      operationId: getVehicleMonitors
      parameters:
        - $ref: '#/components/parameters/channelId'
        - $ref: '#/components/parameters/indexRange'
        - $ref: '#/components/parameters/pageSize'
        - $ref: '#/components/parameters/pageToken'
      security:
        - api_oauth:
            - vehicle
            - channel
            - monitor  
            
      responses:
        200:
          $ref: '#/components/responses/MonitorsuccessResponses'
        default:
          $ref: '#/components/responses/MonitorFailedResponse'
     ##GPOST PART
    post:
      tags:
        - Monitors
      summary: Create a new Monitor.
      description: |
                    Create a Monitor for a Vehicle(s). So it will generate an event following the transition state as defined by the monitor trigger parameter logical expression of vehicle data (like _fuel level_), activity time (like _periode_) and GPS position (_moving out of a defined geographical area_) predicates.
                    
                    
                      * When the trigger occurs, the built event expressed as a JSON (definied in the Event template Specification) object will be sent over the subscribed channel.
                      
                      
                      * All necessary OAuth2 scopes (defined by this API) to satisfy to monitor triggers must be granted when creating the monitor. Scopes involving data triggers are mandatory (see triggers scopes definition) while those of extensions are optional. This means that the missed scope will prevent the associated extension from being defined.
#
      operationId: createVehicleVehicleMonitor
      parameters:
        - $ref: '#/components/parameters/channelId'
      security:
        - api_oauth:
            - vehicle
            - channel
            - monitor:write
            - alert
            - trip
            - collision
            - telemetry:vehicle:odometer
            - telemetry:vehicle:engines
            - telemetry:vehicle:energies
            - telemetry:vehicle:doorsState
            - telemetry:vehicle:kinetic
            - telemetry:vehicle:maintenance
            - telemetry:vehicle:safety
            - telemetry:environment
            - telemetry:privacy
            - telemetry:vehicle:drivingBehavior
            - telemetry:vehicle:preconditioning

      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/MonitorParameter'
                #DataMonitorParm
      responses: 
        202:
          $ref: '#/components/responses/MonitorsuccessPostResponse'
        default:
          $ref: '#/components/responses/MonitorFailedResponse'

  Vehicle_id_cb_id_monitors_mid_crud:
    ## PUT PART
    put:
      tags:
        - Monitors
      summary: Update an existing Monitor.
      description: |
                    Update an existing ```Monitor``` that has been posted (and accepted previously) for this vehicle. The monitor object (body) provided should be complete (the aggregation is not supported for the update of the ```monitor```). 
                    You can first retrieve this object using the ```GET /monitor/{mid}``` API, then modify it and finally publish it (via this ```PUT API```).
#                    
      operationId: updateVehicleVehicleMonitor
      parameters:
        - $ref: '#/components/parameters/channelId'
        - $ref: '#/components/parameters/monitorId'
      security:
        - api_oauth:
            - channel
            - monitor:write         
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/MonitorParameter'
      responses: 
        202:
          $ref: '#/components/responses/MonitorsuccessPostResponse'
        default:
          $ref: '#/components/responses/MonitorFailedResponse'
    ##GET PART
    get:
      tags:
        - Monitors
      description: Returns information about a specific Monitor.
      summary: Get the monitor by monitor Id.
      operationId: getMonitorsStatusById
      parameters:
        - $ref: '#/components/parameters/channelId'
        - $ref: '#/components/parameters/monitorId'
      security:
        - api_oauth:
            - channel
            - monitor         
      responses:
        200:
          $ref: '#/components/responses/MonitorsuccessResponse'
        default:
          $ref: '#/components/responses/MonitorFailedResponse'
    ## DELETE PART
    delete:
      tags:
        - Monitors
      summary: Delete an existing Monitor.
      description: Stop (disable) an existing Monitor.
      operationId: deleteMonitor
      parameters:
        - $ref: '#/components/parameters/channelId'
        - $ref: '#/components/parameters/monitorId'
      security:
        - api_oauth:
            - channel
            - monitor:write        
      responses:
        204:
          description: Monitor deleted (the response does not include an entity).
        '400':
          description: Invalid ID supplied
        '404':
          description: Monitor not found 

  ch_id_monitor_id_setter_put: 
    put:
      tags:
        - Monitors
      summary: Set a new monitor status.
      description: Set monitor status. 
      operationId: setVehicleVehicleMonitorStatus
      parameters:
        
        - $ref: '#/components/parameters/channelId'
        - $ref: '#/components/parameters/monitorId'
      security:
        - api_oauth:
            - channel
            - monitor:write        
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/MonitorStatusSetter'
      responses: #MonitorId
        202:
          $ref: '#/components/responses/MonitorsuccessPostResponse'
        default:
          $ref: '#/components/responses/MonitorFailedResponse' 
  ch_id_monitor_id_handle: 
    put:
      tags:
        - Monitors
      summary: Handle groups or vehicles.
      description: Add or remove groups or vehicles handled by the monitor.
      operationId: setVehicleVehicleMonitorHDL
      parameters:
        
        - $ref: '#/components/parameters/channelId'
        - $ref: '#/components/parameters/monitorId'
      security:
        - api_oauth:
            - channel
            - monitor:write        
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/HandleSetter'
      responses: #MonitorId
        202:
          $ref: '#/components/responses/MonitorsuccessPostResponse'
        default:
          $ref: '#/components/responses/MonitorFailedResponse' 
  channels_crud: 
    get:
      tags:
        - Channels
      summary: Get all channels.
      description: Returns the list of subscribed channels.
      operationId: gettRemotes
      parameters:
          
          
          - $ref: '#/components/parameters/channelType'
          - $ref: '#/components/parameters/indexRange'
          - $ref: '#/components/parameters/pageSize'
          - $ref: '#/components/parameters/pageToken'
      security:
        - api_oauth:
            - channel         
      responses:
        200:
          $ref: '#/components/responses/ChannelSuccessResponses' 
        default:
          $ref: '#/components/responses/ChannelFailedResponse'
    #ChannelId      
    post:
        tags:
          - Channels
        summary: Register a new reusable channel.
        description:  Create a new reusable channel. 
        operationId: settVehicleRemote
          
        requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/ChannelSubscribe'
        responses: #MonitorId
          200:
            $ref: '#/components/responses/channelSuccessPostResponse'
          default:
            $ref: '#/components/responses/ChannelFailedResponse'
  channel_id_crud: 
    put:
        tags:
          - Channels
        summary: Update an existing  channel.
        description: Update an existing ```channel``` that has been posted (and accepted previously). The channel object (body) provided should be complete (aggregation is not supported for the update). This object can be retrieved  using the ```GET /remote/channels/{chId}``` API then modify it and finally publish it (via this ```PUT API```) 

        operationId: settVehicleRemoteById
        parameters:
          - $ref: '#/components/parameters/channelId'
        security:
          - api_oauth:
              - channel:write          
        requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/ChannelSubscribe'
        responses: #MonitorId
          202:
            $ref: '#/components/responses/channelSuccessPostResponse'
          default:
            $ref: '#/components/responses/ChannelFailedResponse'
    get:
      tags:
        - Channels
      summary: Get a channel.
      description: Returns a subscribed channel by subscribe ID.
      operationId: gettRemotebyId
      parameters:
          - $ref: '#/components/parameters/channelId'
      security:
        - api_oauth:
            - channel
      responses:
        200:
          $ref: '#/components/responses/channelSuccessResponse' 
        default:
          $ref: '#/components/responses/ChannelFailedResponse'
    delete:
      tags:
        - Channels
      summary: Delete an existing channel.
      description: Remove an existing channel if and only if there is no pending remote attached to it.
      operationId: deletetRemote
      parameters:   
        - $ref: '#/components/parameters/channelId'
      security:
        - api_oauth:
            - channel:write  
      responses:
        204:
          description: channel deleted (the response does not include an entity)
        '400':
          description: Invalid ID supplied
        '404':
          description: channel not found

  channel_id_status_put:  
    put:
      tags:
        - Channels
      summary: Set an existing channel new status.
      description: Set the channel status.```Paused``` means that the channel will not post any event.
      operationId: setChannelStatus
      parameters:
        - $ref: '#/components/parameters/channelId'
      security:
        - api_oauth:
            - vehicle
            - channel:write       
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/ChannelStatusSetter'
      responses: #MonitorId
        202:
          $ref: '#/components/responses/channelSuccessPostResponse'
        default:
          $ref: '#/components/responses/ChannelFailedResponse'

  Vehicle_id_channel_id_remotes_crud:
    post:
      tags:
        - Remotes
      summary: Send a remote action to a vehicle.
      description: |
                      Create a new asynchrone vehicle remote action and request it.
                      The REMOTE action is specified by the Remote object which offers a set of possible actions (preconditioning, immobilization, door, horn, charging, stolen, lights, wakeup, navigation). 
                      
                      The remote resource creation  is also related to a channel that will serve as a remote action result event callback channel.
                       
                       However, each remote action needs a different permissions set.
                        This API has therefore defined a set of SCOPE OAUTH2 to cover all possible actions. But the API caller should only have the SCOPEs necessary for the action his is requesting for. The necessary scopes  for each action are defined as follows:
                        
                      |<b>Remote action</b>  |<b>Scope</b>  | 
                      |---|---|
                      |preconditioning| remote:preconditioning:write|
                      |immobilization| remote:immo:write|
                      |door - lock action| remote:door:lock:write|
                      |door - unlock action| remote:door:unlock:write|
                      |horn| remote:horn:write|
                      |charging| remote:charging:write|
                      |stolen| remote:stolen:write|
                      |lights| remote:lights:write|
                      |wakeup| remote:weakup:write|
                      |navigation| remote:navigation:write|                        
                        
                        
                       The backend server will introspect the OAuth2 provided token and check if it contains the necessary scope authorization to perform the requested remote action. or raise an unauthorized error status.
#      
      operationId: sendRemoteToVhl
      parameters:
          - $ref: '#/components/parameters/vehicleId'
          - $ref: '#/components/parameters/channelId'
          - $ref: '#/components/parameters/remoteToken'
      security:
        - api_oauth:
            - vehicle
            - channel    
            - remote:write
      requestBody:
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/Remote'
      responses: #MonitorId
          202:
            $ref: '#/components/responses/RemoteActionsSuccessPostResponse'
          default:
            $ref: '#/components/responses/ChannelFailedResponse'
  
    get:
      tags:
        - Remotes
      summary: Get all remote action of vehicle and channel.
      description: Returns the list of action remote requested for vehicle.
      operationId: getRemoteRequestsForVhl
      parameters:
          - $ref: '#/components/parameters/vehicleId'
          - $ref: '#/components/parameters/channelId'
          - $ref: '#/components/parameters/indexRange'
          - $ref: '#/components/parameters/pageSize'
          - $ref: '#/components/parameters/pageToken'
      security:
        - api_oauth:
            - vehicle
            - channel    
            - remote          
      responses:
        200:
          $ref: '#/components/responses/RemoteActionSuccessResponses' 
        default:
          $ref: '#/components/responses/ChannelFailedResponse'

  Vehicle_id_channel_id_remotes_id_getter:
     get:
      tags:
        - Remotes
      summary: Get remote action by id.
      description: Returns the remote action requested for vehicle by ID.
      operationId: getRemoteRequestForVhlById
      parameters:
          - $ref: '#/components/parameters/vehicleId'
          - $ref: '#/components/parameters/channelId'
          - $ref: '#/components/parameters/remoteId'
      security:
        - api_oauth:
            - vehicle
            - channel    
            - remote          
      responses:
        200:
          $ref: '#/components/responses/RemoteActionSuccessResponse' 
        default:
          $ref: '#/components/responses/ChannelFailedResponse'
  
  ch_id_ds_id_handle: 
    put:
      tags:
        - Datastream
      summary: Handle groups or vehicles.
      description: Add or remove groups or vehicles handled by the a data stream. 
      operationId: setDsHDL
      parameters:
        
        - $ref: '#/components/parameters/channelId'
        - $ref: '#/components/parameters/datastreamId'
      security:
        - api_oauth:
            - channel
            - monitor:write        
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/HandleSetter'
      responses: #MonitorId
        202:
          $ref: '#/components/responses/DatastreamSuccessResponse'
        default:
          $ref: '#/x-fragment/general_error_fragment' 

  Vehicle_id_alarms_getter:
       get:
        tags:
          - Vehicles
        description: | 
          Returns a (filtered) list of alarm for a Vehicle.
          *Note:* Timestamp filtering concerns the creation date for status or trigger. 
        summary: Vehicle's Alarms
        operationId: getVehicleAlarms
        parameters:
          - $ref: '#/components/parameters/vehicleId'
          - $ref: '#/components/parameters/alarmType'
          - $ref: '#/components/parameters/timestamps'
          - $ref: '#/components/parameters/indexRange'
          - $ref: '#/components/parameters/pageSize'
          - $ref: '#/components/parameters/pageToken'
        security:
          - api_oauth:
              - alert_read
              - vehicle_read
        responses:
          '200':
            $ref: '#/components/responses/AlarmSuccessResponses'
          default:
            $ref: '#/components/responses/AlarmFailedResponse'
  Vehicle_id_alarm_aid_getter:
    get:
        tags:
          - Vehicles
        description: Returns information about a specific alarm for a Vehicle.
        summary: Vehicle's Alarm
        operationId: getVehicleAlarmsById
        parameters:
          - $ref: '#/components/parameters/vehicleId'
          - $ref: '#/components/parameters/alarmId'
        security:
          - api_oauth:
              - alert_read
              - vehicle_read
        responses:
          '200':
            $ref: '#/components/responses/AlarmSucessResponse'
          default:
            $ref: '#/components/responses/AlarmFailedResponse'
  general_error_fragment:
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/xError'